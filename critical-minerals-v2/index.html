<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Critical Minerals Tracker â€” Prospector Labs</title>
    <link href="https://cdn.jsdelivr.net/npm/geist@1.2.0/dist/fonts/geist-sans/style.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-sankey@0.12.0/dist/chartjs-chart-sankey.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --black: #000000;
            --charcoal: #18181B;
            --graphite: #27272A;
            --zinc: #3F3F46;
            --stone: #71717A;
            --silver: #A1A1AA;
            --smoke: #E4E4E7;
            --cloud: #F4F4F5;
            --white: #FFFFFF;
            --electric: #3B82F6;
            --ember: #F59E0B;
            --jade: #10B981;
            --coral: #EF4444;
            --violet: #8B5CF6;
            --cyan: #06B6D4;
        }
        
        body {
            font-family: 'Geist', system-ui, sans-serif;
            background: var(--charcoal);
            color: var(--white);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 48px 24px;
        }
        
        /* Typography */
        .display { font-size: 48px; font-weight: 600; line-height: 1.1; letter-spacing: -0.02em; }
        .h1 { font-size: 32px; font-weight: 600; line-height: 1.2; letter-spacing: -0.02em; }
        .h2 { font-size: 24px; font-weight: 600; line-height: 1.3; }
        .h3 { font-size: 18px; font-weight: 600; line-height: 1.4; }
        .body { font-size: 15px; font-weight: 400; line-height: 1.6; }
        .small { font-size: 13px; font-weight: 400; line-height: 1.5; color: var(--stone); }
        .micro { font-size: 11px; font-weight: 500; line-height: 1.4; text-transform: uppercase; letter-spacing: 0.05em; }
        .mono { font-family: 'JetBrains Mono', monospace; font-feature-settings: "tnum"; }
        
        /* Header */
        header {
            margin-bottom: 48px;
        }
        
        header .small {
            margin-bottom: 8px;
        }
        
        .subtitle {
            color: var(--stone);
            margin-top: 8px;
            max-width: 600px;
        }
        
        /* Navigation / Mineral Selector */
        .mineral-nav {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 24px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--zinc);
        }
        
        .mineral-btn {
            background: var(--graphite);
            border: 1px solid var(--zinc);
            color: var(--silver);
            padding: 10px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .mineral-btn:hover {
            background: var(--zinc);
            color: var(--white);
        }
        
        .mineral-btn.active {
            background: var(--electric);
            border-color: var(--electric);
            color: var(--white);
        }
        
        .mineral-btn .symbol {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            opacity: 0.7;
            margin-left: 4px;
        }
        
        /* View Tabs */
        .view-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 24px;
            background: var(--graphite);
            padding: 4px;
            border-radius: 8px;
            width: fit-content;
        }
        
        .view-tab {
            background: transparent;
            border: none;
            color: var(--silver);
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .view-tab:hover {
            color: var(--white);
        }
        
        .view-tab.active {
            background: var(--zinc);
            color: var(--white);
        }
        
        /* Grid Layout */
        .grid {
            display: grid;
            gap: 24px;
        }
        
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        
        @media (max-width: 1024px) {
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 640px) {
            .grid-4, .grid-3, .grid-2 { grid-template-columns: 1fr; }
        }
        
        /* Cards */
        .card {
            background: var(--graphite);
            border: 1px solid var(--zinc);
            border-radius: 8px;
            padding: 24px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .card-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--stone);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* Stats */
        .stat-value {
            font-size: 36px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            font-feature-settings: "tnum";
            line-height: 1.1;
        }
        
        .stat-unit {
            font-size: 14px;
            color: var(--stone);
            font-weight: 400;
        }
        
        .stat-change {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 13px;
            font-weight: 500;
            margin-top: 8px;
        }
        
        .stat-change.positive { color: var(--jade); }
        .stat-change.negative { color: var(--coral); }
        
        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 16px;
        }
        
        .chart-container.tall {
            height: 400px;
        }
        
        .chart-container.sankey {
            height: 500px;
        }
        
        /* Bar chart custom */
        .bar-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .bar-label {
            width: 100px;
            font-size: 13px;
            color: var(--silver);
            text-align: right;
            flex-shrink: 0;
        }
        
        .bar-container {
            flex: 1;
            height: 24px;
            background: var(--zinc);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .bar-fill {
            height: 100%;
            background: var(--electric);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .bar-value {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--white);
        }
        
        /* Concentration Risk */
        .risk-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .risk-critical { background: rgba(239, 68, 68, 0.2); color: var(--coral); }
        .risk-high { background: rgba(245, 158, 11, 0.2); color: var(--ember); }
        .risk-moderate { background: rgba(59, 130, 246, 0.2); color: var(--electric); }
        .risk-low { background: rgba(16, 185, 129, 0.2); color: var(--jade); }
        
        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            text-align: left;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--stone);
            padding: 12px 0;
            border-bottom: 1px solid var(--zinc);
        }
        
        .data-table th:last-child,
        .data-table td:last-child {
            text-align: right;
        }
        
        .data-table td {
            padding: 12px 0;
            font-size: 14px;
            border-bottom: 1px solid var(--zinc);
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        .data-table .mono {
            font-size: 13px;
        }
        
        /* Company Cards */
        .company-card {
            background: var(--graphite);
            border: 1px solid var(--zinc);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.15s ease;
        }
        
        .company-card:hover {
            border-color: var(--electric);
            transform: translateY(-2px);
        }
        
        .company-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .company-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
        }
        
        .company-ticker {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--electric);
            background: rgba(59, 130, 246, 0.15);
            padding: 2px 8px;
            border-radius: 4px;
        }
        
        .company-meta {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
            font-size: 12px;
            color: var(--stone);
        }
        
        .company-stat {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .company-stat-label {
            font-size: 11px;
            color: var(--stone);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .company-stat-value {
            font-size: 18px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            color: var(--white);
        }
        
        .company-assets {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 12px;
        }
        
        .asset-tag {
            background: var(--zinc);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            color: var(--silver);
        }
        
        .company-news {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--zinc);
        }
        
        .news-item {
            font-size: 12px;
            color: var(--stone);
            margin-bottom: 4px;
        }
        
        .news-item::before {
            content: "â†’ ";
            color: var(--electric);
        }
        
        /* Company list compact */
        .company-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }
        
        .company-tag {
            background: var(--zinc);
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            color: var(--silver);
        }
        
        /* Use badges */
        .use-badge {
            display: inline-block;
            background: rgba(59, 130, 246, 0.15);
            color: var(--electric);
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            margin-right: 6px;
            margin-bottom: 6px;
        }
        
        /* Info panel */
        .info-panel {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }
        
        .info-panel .micro {
            color: var(--electric);
            margin-bottom: 8px;
        }
        
        /* Supply Chain Flow */
        .supply-chain-flow {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 16px;
        }
        
        .flow-step {
            background: var(--zinc);
            padding: 10px 16px;
            border-radius: 6px;
            font-size: 13px;
            color: var(--silver);
            position: relative;
        }
        
        .flow-step.bottleneck {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: var(--coral);
        }
        
        .flow-arrow {
            color: var(--stone);
            font-size: 18px;
        }
        
        .flow-country {
            display: block;
            font-size: 11px;
            color: var(--stone);
            margin-top: 4px;
        }
        
        /* Section headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .section-header .h2 {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-header .mineral-symbol {
            background: var(--electric);
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 600;
        }
        
        /* Sankey legend */
        .sankey-legend {
            display: flex;
            gap: 24px;
            margin-top: 16px;
            padding: 16px;
            background: var(--graphite);
            border-radius: 8px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--silver);
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
        
        /* Footer */
        footer {
            margin-top: 64px;
            padding-top: 24px;
            border-top: 1px solid var(--zinc);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        footer .small {
            color: var(--stone);
        }
        
        /* Hidden */
        .hidden { display: none !important; }
        
        /* View sections */
        .view-section { display: none; }
        .view-section.active { display: block; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <p class="small micro">Critical Minerals Tracker</p>
            <h1 class="display">Supply Chain Intelligence</h1>
            <p class="subtitle body">Real-time monitoring of critical minerals powering the energy transition. Production, prices, reserves, and supply chain concentration risks.</p>
        </header>
        
        <!-- Mineral Selector -->
        <nav class="mineral-nav" id="mineralNav">
            <button class="mineral-btn active" data-mineral="overview">Overview</button>
            <button class="mineral-btn" data-mineral="lithium">Lithium <span class="symbol">Li</span></button>
            <button class="mineral-btn" data-mineral="cobalt">Cobalt <span class="symbol">Co</span></button>
            <button class="mineral-btn" data-mineral="nickel">Nickel <span class="symbol">Ni</span></button>
            <button class="mineral-btn" data-mineral="copper">Copper <span class="symbol">Cu</span></button>
            <button class="mineral-btn" data-mineral="graphite">Graphite <span class="symbol">C</span></button>
            <button class="mineral-btn" data-mineral="rareEarths">Rare Earths <span class="symbol">REE</span></button>
            <button class="mineral-btn" data-mineral="gallium">Gallium <span class="symbol">Ga</span></button>
            <button class="mineral-btn" data-mineral="germanium">Germanium <span class="symbol">Ge</span></button>
        </nav>
        
        <!-- View Tabs (for mineral detail) -->
        <div class="view-tabs" id="viewTabs" style="display: none;">
            <button class="view-tab active" data-view="overview">Overview</button>
            <button class="view-tab" data-view="companies">Companies</button>
            <button class="view-tab" data-view="supplychain">Supply Chain</button>
            <button class="view-tab" data-view="tradeflows">Trade Flows</button>
        </div>
        
        <!-- Main Content Area -->
        <main id="mainContent">
            <!-- Overview Section (default) -->
            <section id="overviewSection">
                <!-- Key Stats Grid -->
                <div class="grid grid-4" style="margin-bottom: 32px;">
                    <div class="card">
                        <p class="card-title">Lithium Price</p>
                        <p class="stat-value">134,500 <span class="stat-unit">CNY/t</span></p>
                        <p class="stat-change positive">â†‘ 74% YoY</p>
                    </div>
                    <div class="card">
                        <p class="card-title">Cobalt Price</p>
                        <p class="stat-value">56,290 <span class="stat-unit">USD/t</span></p>
                        <p class="stat-change positive">â†‘ 161% YoY</p>
                    </div>
                    <div class="card">
                        <p class="card-title">Nickel Price</p>
                        <p class="stat-value">17,033 <span class="stat-unit">USD/t</span></p>
                        <p class="stat-change positive">â†‘ 8.2% YoY</p>
                    </div>
                    <div class="card">
                        <p class="card-title">Copper Price</p>
                        <p class="stat-value">5.85 <span class="stat-unit">USD/lb</span></p>
                        <p class="stat-change positive">â†‘ 27.6% YoY</p>
                    </div>
                </div>
                
                <!-- Concentration Risks -->
                <div class="grid grid-2">
                    <div class="card">
                        <p class="card-title">Supply Concentration Risk</p>
                        <p class="small" style="margin-bottom: 16px;">Single-country dominance in critical supply chains</p>
                        
                        <div style="margin-top: 16px;">
                            <div class="bar-row">
                                <span class="bar-label">Gallium</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 96%; background: var(--coral);"></div>
                                    <span class="bar-value">China 96%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">Graphite Anode</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 95%; background: var(--coral);"></div>
                                    <span class="bar-value">China 95%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">REE Magnets</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 92%; background: var(--coral);"></div>
                                    <span class="bar-value">China 92%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">REE Processing</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 90%; background: var(--coral);"></div>
                                    <span class="bar-value">China 90%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">Cobalt Refining</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 72%; background: var(--ember);"></div>
                                    <span class="bar-value">China 72%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">Cobalt Mining</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 68%; background: var(--ember);"></div>
                                    <span class="bar-value">DRC 68%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">Lithium Processing</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 65%; background: var(--ember);"></div>
                                    <span class="bar-value">China 65%</span>
                                </div>
                            </div>
                            <div class="bar-row">
                                <span class="bar-label">Nickel Mining</span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 50%; background: var(--electric);"></div>
                                    <span class="bar-value">Indonesia 50%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <p class="card-title">Top Mining Companies by Mineral</p>
                        <div class="chart-container">
                            <canvas id="companiesChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Top Companies Overview -->
                <div class="card" style="margin-top: 24px;">
                    <p class="card-title">Major Players Across Critical Minerals</p>
                    <p class="small" style="margin-bottom: 16px;">Key companies dominating the critical minerals supply chain</p>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Company</th>
                                <th>HQ</th>
                                <th>Minerals</th>
                                <th>Role</th>
                                <th>Market Position</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Glencore</strong></td>
                                <td class="mono">ðŸ‡¨ðŸ‡­ Switzerland</td>
                                <td>Cobalt, Copper, Nickel, Zinc</td>
                                <td>Mining & Trading</td>
                                <td><span class="risk-badge risk-moderate">#1 Cobalt</span></td>
                            </tr>
                            <tr>
                                <td><strong>Albemarle</strong></td>
                                <td class="mono">ðŸ‡ºðŸ‡¸ USA</td>
                                <td>Lithium</td>
                                <td>Mining & Processing</td>
                                <td><span class="risk-badge risk-moderate">#1 Lithium</span></td>
                            </tr>
                            <tr>
                                <td><strong>Ganfeng Lithium</strong></td>
                                <td class="mono">ðŸ‡¨ðŸ‡³ China</td>
                                <td>Lithium</td>
                                <td>Integrated</td>
                                <td><span class="risk-badge risk-moderate">#3 Lithium</span></td>
                            </tr>
                            <tr>
                                <td><strong>China Northern Rare Earth</strong></td>
                                <td class="mono">ðŸ‡¨ðŸ‡³ China</td>
                                <td>Rare Earths</td>
                                <td>Mining & Processing</td>
                                <td><span class="risk-badge risk-critical">#1 REE</span></td>
                            </tr>
                            <tr>
                                <td><strong>Tsingshan</strong></td>
                                <td class="mono">ðŸ‡¨ðŸ‡³ China</td>
                                <td>Nickel, Stainless Steel</td>
                                <td>Integrated</td>
                                <td><span class="risk-badge risk-high">#1 Nickel</span></td>
                            </tr>
                            <tr>
                                <td><strong>Codelco</strong></td>
                                <td class="mono">ðŸ‡¨ðŸ‡± Chile</td>
                                <td>Copper</td>
                                <td>State Mining</td>
                                <td><span class="risk-badge risk-moderate">#1 Copper</span></td>
                            </tr>
                            <tr>
                                <td><strong>BTR New Material</strong></td>
                                <td class="mono">ðŸ‡¨ðŸ‡³ China</td>
                                <td>Graphite Anode</td>
                                <td>Processing</td>
                                <td><span class="risk-badge risk-critical">#1 Anode</span></td>
                            </tr>
                            <tr>
                                <td><strong>MP Materials</strong></td>
                                <td class="mono">ðŸ‡ºðŸ‡¸ USA</td>
                                <td>Rare Earths</td>
                                <td>Mining</td>
                                <td><span class="risk-badge risk-low">Key Western Player</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Data Quality Matrix -->
                <div class="card" style="margin-top: 24px;">
                    <p class="card-title">Data Availability by Mineral</p>
                    <p class="small" style="margin-bottom: 16px;">Quality assessment of publicly available data sources</p>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Mineral</th>
                                <th>Price Data</th>
                                <th>Production</th>
                                <th>Reserves</th>
                                <th>Companies</th>
                                <th>Data Quality</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Lithium</strong></td>
                                <td class="mono">âœ“ Trading Economics</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ Public</td>
                                <td><span class="risk-badge risk-low">Excellent</span></td>
                            </tr>
                            <tr>
                                <td><strong>Cobalt</strong></td>
                                <td class="mono">âœ“ LME/TE</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ Public</td>
                                <td><span class="risk-badge risk-moderate">Good</span></td>
                            </tr>
                            <tr>
                                <td><strong>Nickel</strong></td>
                                <td class="mono">âœ“ LME/TE</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ Public</td>
                                <td><span class="risk-badge risk-low">Excellent</span></td>
                            </tr>
                            <tr>
                                <td><strong>Copper</strong></td>
                                <td class="mono">âœ“ COMEX/TE</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ Public</td>
                                <td><span class="risk-badge risk-low">Excellent</span></td>
                            </tr>
                            <tr>
                                <td><strong>Graphite</strong></td>
                                <td class="mono">â–³ Industry est.</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">â–³ Limited</td>
                                <td><span class="risk-badge risk-high">Moderate</span></td>
                            </tr>
                            <tr>
                                <td><strong>Rare Earths</strong></td>
                                <td class="mono">â–³ Paid sources</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ“ Public</td>
                                <td><span class="risk-badge risk-high">Moderate</span></td>
                            </tr>
                            <tr>
                                <td><strong>Gallium</strong></td>
                                <td class="mono">â–³ Industry est.</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ— N/A</td>
                                <td class="mono">âœ— Limited</td>
                                <td><span class="risk-badge risk-critical">Limited</span></td>
                            </tr>
                            <tr>
                                <td><strong>Germanium</strong></td>
                                <td class="mono">â–³ Industry est.</td>
                                <td class="mono">âœ“ USGS</td>
                                <td class="mono">âœ— N/A</td>
                                <td class="mono">âœ— Limited</td>
                                <td><span class="risk-badge risk-critical">Limited</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="info-panel">
                        <p class="micro">Data Sources</p>
                        <p class="small">âœ“ = Freely available public data | â–³ = Requires paid sources or estimates | âœ— = Data not available</p>
                        <p class="small" style="margin-top: 8px;"><strong>Primary Sources:</strong> USGS Mineral Commodity Summaries, Trading Economics, LME, COMEX, Company Reports</p>
                    </div>
                </div>
            </section>
            
            <!-- Individual Mineral Sections -->
            <section id="mineralDetail" style="display: none;">
                <div class="section-header">
                    <div class="h2">
                        <div class="mineral-symbol" id="mineralSymbol">Li</div>
                        <span id="mineralName">Lithium</span>
                    </div>
                    <div id="mineralUses"></div>
                </div>
                
                <!-- Overview View -->
                <div class="view-section active" id="viewOverview">
                    <!-- Price & Stats -->
                    <div class="grid grid-4" style="margin-bottom: 24px;">
                        <div class="card">
                            <p class="card-title">Current Price</p>
                            <p class="stat-value" id="detailPrice">-</p>
                            <p class="stat-change" id="detailPriceChange">-</p>
                        </div>
                        <div class="card">
                            <p class="card-title">All-Time High</p>
                            <p class="stat-value" id="detailHigh">-</p>
                            <p class="small" id="detailHighDate">-</p>
                        </div>
                        <div class="card">
                            <p class="card-title">World Production</p>
                            <p class="stat-value" id="detailProduction">-</p>
                            <p class="small" id="detailProductionUnit">tonnes</p>
                        </div>
                        <div class="card">
                            <p class="card-title">World Reserves</p>
                            <p class="stat-value" id="detailReserves">-</p>
                            <p class="small" id="detailReservesUnit">tonnes</p>
                        </div>
                    </div>
                    
                    <!-- Production & Reserves Charts -->
                    <div class="grid grid-2" style="margin-bottom: 24px;">
                        <div class="card">
                            <p class="card-title">Production by Country</p>
                            <div id="productionBars"></div>
                        </div>
                        <div class="card">
                            <p class="card-title">Reserves by Country</p>
                            <div id="reservesBars"></div>
                        </div>
                    </div>
                    
                    <!-- Concentration Risk -->
                    <div class="card" id="concentrationCard">
                        <p class="card-title">Concentration Risk Assessment</p>
                        <div id="concentrationInfo"></div>
                    </div>
                </div>
                
                <!-- Companies View -->
                <div class="view-section" id="viewCompanies">
                    <div class="grid grid-2" style="margin-bottom: 24px;">
                        <div class="card">
                            <p class="card-title">Mining Companies</p>
                            <div id="miningCompanies"></div>
                        </div>
                        <div class="card">
                            <p class="card-title">Processing Companies</p>
                            <div id="processingCompanies"></div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <p class="card-title">Top Companies Detailed</p>
                        <div class="grid grid-2" id="companyCards" style="margin-top: 16px;"></div>
                    </div>
                </div>
                
                <!-- Supply Chain View -->
                <div class="view-section" id="viewSupplychain">
                    <div class="card">
                        <p class="card-title">Supply Chain Stages</p>
                        <div id="supplyChainStages"></div>
                    </div>
                    
                    <div class="card" style="margin-top: 24px;">
                        <p class="card-title">Supply Chain Flow</p>
                        <div class="chart-container sankey">
                            <canvas id="sankeyChart"></canvas>
                        </div>
                        <div class="sankey-legend" id="sankeyLegend"></div>
                    </div>
                </div>
                
                <!-- Trade Flows View -->
                <div class="view-section" id="viewTradeflows">
                    <div class="card">
                        <p class="card-title">Major Export Routes</p>
                        <div id="exportRoutes"></div>
                    </div>
                    
                    <div class="grid grid-2" style="margin-top: 24px;">
                        <div class="card">
                            <p class="card-title">Top Exporters</p>
                            <div id="exporters"></div>
                        </div>
                        <div class="card">
                            <p class="card-title">Top Importers</p>
                            <div id="importers"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer>
            <p class="small">Last updated: February 6, 2026 | Data: USGS, Trading Economics, Industry Reports, Company Filings</p>
            <p class="small">prospectorlabs.io</p>
        </footer>
    </div>
    
    <script>
        // Data stores
        let mineralsData = null;
        let companiesData = null;
        let tradeFlowsData = null;
        let supplyChainData = null;
        let currentMineral = 'overview';
        let currentView = 'overview';
        let sankeyChart = null;
        
        // Load all data
        async function loadData() {
            try {
                const [minerals, companies, tradeFlows, supplyChain] = await Promise.all([
                    fetch('data/minerals.json').then(r => r.json()),
                    fetch('data/companies.json').then(r => r.json()),
                    fetch('data/trade-flows.json').then(r => r.json()),
                    fetch('data/supply-chain-steps.json').then(r => r.json())
                ]);
                
                mineralsData = minerals;
                companiesData = companies;
                tradeFlowsData = tradeFlows;
                supplyChainData = supplyChain;
                
                initCharts();
            } catch (e) {
                console.error('Error loading data:', e);
            }
        }
        
        // Initialize charts
        function initCharts() {
            // Companies overview chart
            const ctx = document.getElementById('companiesChart');
            if (ctx) {
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Lithium', 'Cobalt', 'Nickel', 'Copper', 'REE', 'Graphite'],
                        datasets: [{
                            label: 'Top 3 Companies Share %',
                            data: [49, 46, 29, 24, 58, 45],
                            backgroundColor: ['#3B82F6', '#EF4444', '#F59E0B', '#10B981', '#8B5CF6', '#06B6D4'],
                            borderRadius: 4
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: {
                                grid: { color: '#3F3F46', drawBorder: false },
                                ticks: { color: '#A1A1AA' },
                                max: 100
                            },
                            y: {
                                grid: { display: false },
                                ticks: { color: '#A1A1AA' }
                            }
                        }
                    }
                });
            }
        }
        
        // Navigation handlers
        document.querySelectorAll('.mineral-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mineral-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const mineral = btn.dataset.mineral;
                currentMineral = mineral;
                
                if (mineral === 'overview') {
                    document.getElementById('overviewSection').style.display = 'block';
                    document.getElementById('mineralDetail').style.display = 'none';
                    document.getElementById('viewTabs').style.display = 'none';
                } else {
                    document.getElementById('overviewSection').style.display = 'none';
                    document.getElementById('mineralDetail').style.display = 'block';
                    document.getElementById('viewTabs').style.display = 'flex';
                    showMineralDetail(mineral);
                }
            });
        });
        
        // View tab handlers
        document.querySelectorAll('.view-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.view-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                const view = tab.dataset.view;
                currentView = view;
                
                document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
                document.getElementById('view' + view.charAt(0).toUpperCase() + view.slice(1)).classList.add('active');
                
                // Refresh view-specific data
                if (view === 'supplychain') {
                    renderSupplyChain(currentMineral);
                } else if (view === 'companies') {
                    renderCompanies(currentMineral);
                } else if (view === 'tradeflows') {
                    renderTradeFlows(currentMineral);
                }
            });
        });
        
        function showMineralDetail(mineralKey) {
            if (!mineralsData) return;
            
            const mineral = mineralsData.minerals[mineralKey];
            if (!mineral) return;
            
            // Update header
            document.getElementById('mineralSymbol').textContent = mineral.symbol || mineralKey.substring(0, 2).toUpperCase();
            document.getElementById('mineralName').textContent = mineral.name;
            
            // Uses
            const usesDiv = document.getElementById('mineralUses');
            const uses = mineral.primaryUse ? mineral.primaryUse.split(',').map(u => u.trim()) : [];
            usesDiv.innerHTML = uses.map(u => `<span class="use-badge">${u}</span>`).join('');
            
            // Price
            const price = mineral.price;
            if (price) {
                document.getElementById('detailPrice').innerHTML = `${formatNumber(price.current)} <span class="stat-unit">${price.unit}</span>`;
                const changeClass = price.yearOverYearChange >= 0 ? 'positive' : 'negative';
                const arrow = price.yearOverYearChange >= 0 ? 'â†‘' : 'â†“';
                document.getElementById('detailPriceChange').className = `stat-change ${changeClass}`;
                document.getElementById('detailPriceChange').textContent = `${arrow} ${Math.abs(price.yearOverYearChange).toFixed(1)}% YoY`;
                document.getElementById('detailHigh').innerHTML = `${formatNumber(price.historicalHigh)} <span class="stat-unit">${price.unit}</span>`;
                document.getElementById('detailHighDate').textContent = price.historicalHighDate || '-';
            } else {
                document.getElementById('detailPrice').textContent = '-';
                document.getElementById('detailPriceChange').textContent = '';
                document.getElementById('detailHigh').textContent = '-';
                document.getElementById('detailHighDate').textContent = '';
            }
            
            // Production
            const prod = mineral.production2024 || mineral.production2023;
            if (prod) {
                document.getElementById('detailProduction').textContent = formatNumber(prod.world);
                document.getElementById('detailProductionUnit').textContent = prod.unit || 'tonnes';
                
                const prodBars = document.getElementById('productionBars');
                prodBars.innerHTML = prod.byCountry ? prod.byCountry.slice(0, 6).map(c => `
                    <div class="bar-row">
                        <span class="bar-label">${c.country}</span>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${c.share}%;"></div>
                            <span class="bar-value">${c.share}%</span>
                        </div>
                    </div>
                `).join('') : '<p class="small">No data available</p>';
            }
            
            // Reserves
            const res = mineral.reserves;
            if (res) {
                document.getElementById('detailReserves').textContent = formatNumber(res.world);
                document.getElementById('detailReservesUnit').textContent = res.unit || 'tonnes';
                
                const resBars = document.getElementById('reservesBars');
                resBars.innerHTML = res.byCountry ? res.byCountry.slice(0, 6).map(c => `
                    <div class="bar-row">
                        <span class="bar-label">${c.country}</span>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${c.share}%; background: var(--jade);"></div>
                            <span class="bar-value">${c.share}%</span>
                        </div>
                    </div>
                `).join('') : '<p class="small">No reserves data available</p>';
            } else {
                document.getElementById('detailReserves').textContent = '-';
                document.getElementById('reservesBars').innerHTML = '<p class="small">No reserves data available</p>';
            }
            
            // Concentration info
            renderConcentrationInfo(mineralKey);
            
            // Load companies if on that view
            if (currentView === 'companies') {
                renderCompanies(mineralKey);
            } else if (currentView === 'supplychain') {
                renderSupplyChain(mineralKey);
            } else if (currentView === 'tradeflows') {
                renderTradeFlows(mineralKey);
            }
        }
        
        function renderConcentrationInfo(mineralKey) {
            if (!companiesData) return;
            
            const companyInfo = companiesData.companies[mineralKey];
            const concentrationDiv = document.getElementById('concentrationInfo');
            
            if (!companyInfo || !companyInfo.concentration) {
                concentrationDiv.innerHTML = '<p class="small">No concentration data available</p>';
                return;
            }
            
            const conc = companyInfo.concentration;
            let html = '<div class="grid grid-2" style="gap: 16px; margin-top: 16px;">';
            
            // Mining concentration
            if (conc.mining) {
                const riskClass = conc.mining.riskLevel === 'critical' ? 'risk-critical' : 
                                  conc.mining.riskLevel === 'high' ? 'risk-high' : 'risk-moderate';
                html += `
                    <div>
                        <p class="micro" style="color: var(--stone); margin-bottom: 8px;">Mining Concentration</p>
                        ${conc.mining.chinaShare ? `<p class="body"><strong>China:</strong> ${conc.mining.chinaShare}%</p>` : ''}
                        ${conc.mining.drcShare ? `<p class="body"><strong>DRC:</strong> ${conc.mining.drcShare}%</p>` : ''}
                        ${conc.mining.indonesiaShare ? `<p class="body"><strong>Indonesia:</strong> ${conc.mining.indonesiaShare}%</p>` : ''}
                        ${conc.mining.top3Share ? `<p class="body"><strong>Top 3:</strong> ${conc.mining.top3Share}%</p>` : ''}
                        <span class="risk-badge ${riskClass}" style="margin-top: 8px;">${conc.mining.riskLevel} risk</span>
                    </div>
                `;
            }
            
            // Processing concentration
            if (conc.processing) {
                const riskClass = conc.processing.riskLevel === 'critical' ? 'risk-critical' : 
                                  conc.processing.riskLevel === 'high' ? 'risk-high' : 'risk-moderate';
                html += `
                    <div>
                        <p class="micro" style="color: var(--stone); margin-bottom: 8px;">Processing Concentration</p>
                        ${conc.processing.chinaShare ? `<p class="body"><strong>China:</strong> ${conc.processing.chinaShare}%</p>` : ''}
                        <span class="risk-badge ${riskClass}" style="margin-top: 8px;">${conc.processing.riskLevel} risk</span>
                    </div>
                `;
            }
            
            // Magnets (for REE)
            if (conc.magnets) {
                const riskClass = 'risk-critical';
                html += `
                    <div style="grid-column: span 2;">
                        <p class="micro" style="color: var(--stone); margin-bottom: 8px;">Magnet Manufacturing</p>
                        <p class="body"><strong>China:</strong> ${conc.magnets.chinaShare}%</p>
                        <span class="risk-badge ${riskClass}" style="margin-top: 8px;">critical risk</span>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Concerns
            const concerns = conc.mining?.concerns || conc.processing?.concerns || conc.magnets?.concerns;
            if (concerns && concerns.length > 0) {
                html += `
                    <div class="info-panel" style="background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); margin-top: 16px;">
                        <p class="micro" style="color: var(--coral);">Supply Chain Concerns</p>
                        ${concerns.map(c => `<p class="small">â€¢ ${c}</p>`).join('')}
                    </div>
                `;
            }
            
            concentrationDiv.innerHTML = html;
        }
        
        function renderCompanies(mineralKey) {
            if (!companiesData) return;
            
            const companyInfo = companiesData.companies[mineralKey];
            if (!companyInfo) {
                document.getElementById('miningCompanies').innerHTML = '<p class="small">No company data available</p>';
                document.getElementById('processingCompanies').innerHTML = '<p class="small">No company data available</p>';
                document.getElementById('companyCards').innerHTML = '';
                return;
            }
            
            // Mining companies list
            const miningDiv = document.getElementById('miningCompanies');
            const mining = companyInfo.mining || companyInfo.production || [];
            miningDiv.innerHTML = mining.length > 0 ? mining.slice(0, 8).map(c => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--zinc);">
                    <div>
                        <p style="font-weight: 500; color: var(--white);">${c.name}</p>
                        <p class="small">${c.hq}</p>
                    </div>
                    <div style="text-align: right;">
                        ${c.ticker ? `<span class="company-ticker">${c.ticker}</span>` : ''}
                        ${c.marketShare ? `<p class="mono small" style="margin-top: 4px;">${c.marketShare}% share</p>` : ''}
                    </div>
                </div>
            `).join('') : '<p class="small">No mining company data</p>';
            
            // Processing companies list
            const processingDiv = document.getElementById('processingCompanies');
            const processing = companyInfo.processing || companyInfo.smelting || [];
            processingDiv.innerHTML = processing.length > 0 ? processing.slice(0, 6).map(c => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--zinc);">
                    <div>
                        <p style="font-weight: 500; color: var(--white);">${c.name}</p>
                        <p class="small">${c.hq || c.type || ''}</p>
                    </div>
                    <div style="text-align: right;">
                        ${c.marketShare ? `<p class="mono small">${c.marketShare}% share</p>` : ''}
                    </div>
                </div>
            `).join('') : '<p class="small">No processing company data</p>';
            
            // Detailed company cards
            const cardsDiv = document.getElementById('companyCards');
            const topCompanies = mining.slice(0, 4);
            cardsDiv.innerHTML = topCompanies.map(c => `
                <div class="company-card">
                    <div class="company-header">
                        <span class="company-name">${c.name}</span>
                        ${c.ticker ? `<span class="company-ticker">${c.ticker}</span>` : ''}
                    </div>
                    <div class="company-meta">
                        <span>ðŸ“ ${c.hq}</span>
                        ${c.exchange ? `<span>ðŸ“ˆ ${c.exchange}</span>` : ''}
                    </div>
                    <div style="display: flex; gap: 24px; margin-top: 12px;">
                        ${c.marketShare ? `
                            <div class="company-stat">
                                <span class="company-stat-label">Market Share</span>
                                <span class="company-stat-value">${c.marketShare}%</span>
                            </div>
                        ` : ''}
                        ${c.production2024 ? `
                            <div class="company-stat">
                                <span class="company-stat-label">Production</span>
                                <span class="company-stat-value">${formatNumber(c.production2024)}</span>
                            </div>
                        ` : ''}
                    </div>
                    ${c.keyAssets ? `
                        <div class="company-assets">
                            ${c.keyAssets.slice(0, 3).map(a => `<span class="asset-tag">${a}</span>`).join('')}
                        </div>
                    ` : ''}
                    ${c.recentNews ? `
                        <div class="company-news">
                            ${c.recentNews.slice(0, 2).map(n => `<p class="news-item">${n}</p>`).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }
        
        function renderSupplyChain(mineralKey) {
            if (!supplyChainData) return;
            
            const chain = supplyChainData.supplyChains[mineralKey];
            const stagesDiv = document.getElementById('supplyChainStages');
            
            if (!chain) {
                stagesDiv.innerHTML = '<p class="small">No supply chain data available</p>';
                return;
            }
            
            // Supply chain flow visualization
            let flowHtml = '<div class="supply-chain-flow">';
            chain.stages.forEach((stage, i) => {
                const isBottleneck = stage.bottleneck || 
                    (stage.dominantCountries && stage.dominantCountries.some(c => c.includes('China') && parseFloat(c.match(/\d+/)?.[0]) > 60));
                flowHtml += `
                    <div class="flow-step ${isBottleneck ? 'bottleneck' : ''}">
                        ${stage.name}
                        <span class="flow-country">${stage.dominantCountries ? stage.dominantCountries[0] : ''}</span>
                    </div>
                `;
                if (i < chain.stages.length - 1) {
                    flowHtml += '<span class="flow-arrow">â†’</span>';
                }
            });
            flowHtml += '</div>';
            
            // Detailed stages
            let stagesHtml = flowHtml + '<div style="margin-top: 24px;">';
            chain.stages.forEach(stage => {
                const isBottleneck = stage.bottleneck;
                stagesHtml += `
                    <div style="padding: 16px; background: ${isBottleneck ? 'rgba(239, 68, 68, 0.1)' : 'var(--zinc)'}; border-radius: 8px; margin-bottom: 12px; ${isBottleneck ? 'border: 1px solid rgba(239, 68, 68, 0.3);' : ''}">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <p class="h3" style="margin-bottom: 4px;">${stage.stage}. ${stage.name}</p>
                                <p class="small">${stage.description}</p>
                            </div>
                            ${isBottleneck ? '<span class="risk-badge risk-critical">Bottleneck</span>' : ''}
                        </div>
                        ${stage.products ? `
                            <div style="margin-top: 12px;">
                                <p class="micro" style="color: var(--stone); margin-bottom: 4px;">Products</p>
                                <div class="company-list">
                                    ${(Array.isArray(stage.products) ? stage.products : Object.values(stage.products)).slice(0, 4).map(p => 
                                        `<span class="company-tag">${typeof p === 'object' ? JSON.stringify(p) : p}</span>`
                                    ).join('')}
                                </div>
                            </div>
                        ` : ''}
                        ${stage.locations || stage.dominantCountries ? `
                            <div style="margin-top: 12px;">
                                <p class="micro" style="color: var(--stone); margin-bottom: 4px;">Key Locations</p>
                                <p class="small">${(stage.dominantCountries || stage.locations || []).join(' â€¢ ')}</p>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            stagesHtml += '</div>';
            
            stagesDiv.innerHTML = stagesHtml;
            
            // Render Sankey chart
            renderSankeyChart(mineralKey);
        }
        
        function renderSankeyChart(mineralKey) {
            if (!tradeFlowsData) return;
            
            const flows = tradeFlowsData.tradeFlows[mineralKey];
            if (!flows || !flows.sankey) {
                document.getElementById('sankeyChart').style.display = 'none';
                return;
            }
            
            document.getElementById('sankeyChart').style.display = 'block';
            
            // Destroy existing chart
            if (sankeyChart) {
                sankeyChart.destroy();
            }
            
            const ctx = document.getElementById('sankeyChart');
            const sankey = flows.sankey;
            
            // Create sankey data
            const data = sankey.links.map(link => ({
                from: link.source,
                to: link.target,
                flow: link.value
            }));
            
            const colors = {
                mining: '#3B82F6',
                processing: '#F59E0B',
                manufacturing: '#10B981',
                smelting: '#8B5CF6',
                refining: '#06B6D4',
                separation: '#EF4444',
                metals: '#EC4899',
                magnets: '#F97316',
                cells: '#14B8A6',
                anode: '#6366F1',
                enduse: '#10B981'
            };
            
            sankeyChart = new Chart(ctx, {
                type: 'sankey',
                data: {
                    datasets: [{
                        data: data,
                        colorFrom: (c) => {
                            const node = sankey.nodes.find(n => n.id === c.dataset.data[c.dataIndex].from);
                            return node ? colors[node.stage] || '#71717A' : '#71717A';
                        },
                        colorTo: (c) => {
                            const node = sankey.nodes.find(n => n.id === c.dataset.data[c.dataIndex].to);
                            return node ? colors[node.stage] || '#71717A' : '#71717A';
                        },
                        colorMode: 'gradient',
                        labels: sankey.nodes.reduce((acc, n) => { acc[n.id] = n.label; return acc; }, {}),
                        size: 'max'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    const from = context.dataset.labels[context.raw.from] || context.raw.from;
                                    const to = context.dataset.labels[context.raw.to] || context.raw.to;
                                    return `${from} â†’ ${to}: ${context.raw.flow}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Render legend
            const legendDiv = document.getElementById('sankeyLegend');
            const stages = [...new Set(sankey.nodes.map(n => n.stage))];
            legendDiv.innerHTML = stages.map(s => `
                <div class="legend-item">
                    <div class="legend-color" style="background: ${colors[s] || '#71717A'};"></div>
                    <span>${s.charAt(0).toUpperCase() + s.slice(1)}</span>
                </div>
            `).join('');
        }
        
        function renderTradeFlows(mineralKey) {
            if (!tradeFlowsData) return;
            
            const flows = tradeFlowsData.tradeFlows[mineralKey];
            
            if (!flows) {
                document.getElementById('exportRoutes').innerHTML = '<p class="small">No trade flow data available</p>';
                document.getElementById('exporters').innerHTML = '';
                document.getElementById('importers').innerHTML = '';
                return;
            }
            
            // Export routes
            const routesDiv = document.getElementById('exportRoutes');
            if (flows.exports) {
                routesDiv.innerHTML = `
                    <div style="margin-top: 16px;">
                        ${flows.exports.map(e => `
                            <div style="display: flex; align-items: center; gap: 12px; padding: 12px 0; border-bottom: 1px solid var(--zinc);">
                                <span style="font-weight: 500; color: var(--white); min-width: 100px;">${e.from}</span>
                                <span class="flow-arrow">â†’</span>
                                <span style="font-weight: 500; color: var(--white); min-width: 100px;">${e.to}</span>
                                <span class="company-tag">${e.product}</span>
                                <span class="mono" style="margin-left: auto; color: var(--electric);">${e.share}%</span>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            // Exporters
            const exportersDiv = document.getElementById('exporters');
            if (flows.exports) {
                const exporterMap = {};
                flows.exports.forEach(e => {
                    exporterMap[e.from] = (exporterMap[e.from] || 0) + e.share;
                });
                const exporters = Object.entries(exporterMap).sort((a, b) => b[1] - a[1]);
                
                exportersDiv.innerHTML = exporters.map(([country, share]) => `
                    <div class="bar-row">
                        <span class="bar-label">${country}</span>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${Math.min(share, 100)}%; background: var(--electric);"></div>
                            <span class="bar-value">${share}%</span>
                        </div>
                    </div>
                `).join('');
            }
            
            // Importers
            const importersDiv = document.getElementById('importers');
            if (flows.imports) {
                importersDiv.innerHTML = flows.imports.map(i => `
                    <div class="bar-row">
                        <span class="bar-label">${i.country}</span>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${i.share}%; background: var(--jade);"></div>
                            <span class="bar-value">${i.share}%</span>
                        </div>
                    </div>
                `).join('');
            } else {
                // Calculate from exports
                const importerMap = {};
                flows.exports?.forEach(e => {
                    importerMap[e.to] = (importerMap[e.to] || 0) + e.share;
                });
                const importers = Object.entries(importerMap).sort((a, b) => b[1] - a[1]);
                
                importersDiv.innerHTML = importers.map(([country, share]) => `
                    <div class="bar-row">
                        <span class="bar-label">${country}</span>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${Math.min(share, 100)}%; background: var(--jade);"></div>
                            <span class="bar-value">${share}%</span>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        function formatNumber(num) {
            if (num === undefined || num === null) return '-';
            if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return num.toLocaleString();
            return num.toString();
        }
        
        // Initialize
        loadData();
    </script>
</body>
</html>
