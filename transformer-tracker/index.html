<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Supply Chain Intelligence — Prospector Labs</title>
    <link href="https://cdn.jsdelivr.net/npm/geist@1.2.0/dist/fonts/geist-sans/style.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/geist@1.2.0/dist/fonts/geist-mono/style.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-tertiary: #1a1a1a;
            --bg-elevated: #1f1f1f;
            --border: #2a2a2a;
            --border-hover: #3a3a3a;
            --text-primary: #fafafa;
            --text-secondary: #a1a1a1;
            --text-muted: #6a6a6a;
            --accent-blue: #3b82f6;
            --accent-cyan: #22d3ee;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-orange: #f97316;
            --accent-red: #ef4444;
            --accent-purple: #a855f7;
            --gradient-blue: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }
        
        body {
            font-family: 'Geist', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }
        
        /* Header Bar */
        .header-bar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 12px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-blue);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
        }
        
        .logo-text {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: -0.02em;
        }
        
        .logo-text span {
            color: var(--text-muted);
            font-weight: 400;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            font-family: 'Geist Mono', monospace;
        }
        
        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            50% { opacity: 0.8; box-shadow: 0 0 0 4px rgba(16, 185, 129, 0); }
        }
        
        /* Main Layout */
        .main-container {
            display: flex;
            min-height: calc(100vh - 57px);
        }
        
        /* Sidebar Navigation */
        .sidebar {
            width: 240px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 16px 0;
            position: sticky;
            top: 57px;
            height: calc(100vh - 57px);
            overflow-y: auto;
        }
        
        .nav-section {
            padding: 0 12px;
            margin-bottom: 24px;
        }
        
        .nav-section-title {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            padding: 0 12px;
            margin-bottom: 8px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            font-size: 13px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .nav-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        
        .nav-item.active {
            background: var(--accent-blue);
            color: white;
        }
        
        .nav-icon {
            width: 18px;
            height: 18px;
            opacity: 0.7;
        }
        
        .nav-item.active .nav-icon {
            opacity: 1;
        }
        
        /* Content Area */
        .content {
            flex: 1;
            padding: 24px 32px;
            max-width: 1400px;
        }
        
        /* Section Headers */
        .section-header {
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 28px;
            font-weight: 600;
            letter-spacing: -0.03em;
            margin-bottom: 8px;
        }
        
        .section-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent-blue);
        }
        
        .stat-card.warning::before { background: var(--accent-yellow); }
        .stat-card.danger::before { background: var(--accent-red); }
        .stat-card.success::before { background: var(--accent-green); }
        .stat-card.purple::before { background: var(--accent-purple); }
        
        .stat-value {
            font-size: 36px;
            font-weight: 600;
            font-family: 'Geist Mono', monospace;
            line-height: 1.1;
            margin-bottom: 4px;
        }
        
        .stat-value.blue { color: var(--accent-blue); }
        .stat-value.yellow { color: var(--accent-yellow); }
        .stat-value.red { color: var(--accent-red); }
        .stat-value.green { color: var(--accent-green); }
        
        .stat-label {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .stat-change {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            font-family: 'Geist Mono', monospace;
            margin-top: 8px;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .stat-change.up {
            color: var(--accent-red);
            background: rgba(239, 68, 68, 0.1);
        }
        
        .stat-change.down {
            color: var(--accent-green);
            background: rgba(16, 185, 129, 0.1);
        }
        
        /* Chart Containers */
        .chart-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .chart-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .chart-legend {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 2px;
        }
        
        /* Sankey Diagram */
        .sankey-container {
            width: 100%;
            min-height: 400px;
        }
        
        .sankey-container svg {
            width: 100%;
            height: 100%;
        }
        
        .sankey-node rect {
            fill-opacity: 0.9;
            stroke: none;
        }
        
        .sankey-node text {
            font-family: 'Geist', sans-serif;
            font-size: 11px;
            fill: var(--text-primary);
        }
        
        .sankey-link {
            fill: none;
            stroke-opacity: 0.3;
        }
        
        .sankey-link:hover {
            stroke-opacity: 0.6;
        }
        
        /* Treemap */
        .treemap-container {
            width: 100%;
            height: 300px;
        }
        
        .treemap-cell {
            stroke: var(--bg-primary);
            stroke-width: 2px;
        }
        
        .treemap-label {
            font-family: 'Geist', sans-serif;
            font-size: 11px;
            fill: white;
            pointer-events: none;
        }
        
        /* Lead Time Bars */
        .lead-time-chart {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .lead-time-row {
            display: grid;
            grid-template-columns: 180px 1fr 80px;
            align-items: center;
            gap: 16px;
        }
        
        .lead-time-label {
            font-size: 13px;
            font-weight: 500;
        }
        
        .lead-time-label small {
            display: block;
            font-size: 11px;
            font-weight: 400;
            color: var(--text-muted);
        }
        
        .lead-time-track {
            height: 32px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }
        
        .lead-time-segments {
            display: flex;
            height: 100%;
            position: relative;
        }
        
        .lead-time-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            font-size: 11px;
            font-family: 'Geist Mono', monospace;
            color: white;
            position: relative;
        }
        
        .lead-time-segment.pre2020 {
            background: var(--text-muted);
        }
        
        .lead-time-segment.peak {
            background: var(--accent-red);
        }
        
        .lead-time-segment.current {
            background: var(--accent-blue);
        }
        
        .lead-time-value {
            font-size: 14px;
            font-weight: 600;
            font-family: 'Geist Mono', monospace;
            text-align: right;
            color: var(--text-secondary);
        }
        
        /* Horizontal Timeline Bars */
        .timeline-bar-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .timeline-bar-row {
            display: grid;
            grid-template-columns: 160px 1fr;
            gap: 16px;
            align-items: flex-start;
        }
        
        .timeline-bar-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .timeline-bar-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .timeline-bar {
            height: 20px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 10px;
            font-family: 'Geist Mono', monospace;
            color: white;
            min-width: 40px;
            justify-content: center;
        }
        
        .timeline-period-label {
            font-size: 10px;
            color: var(--text-muted);
            width: 60px;
        }
        
        /* Import Dependency Badges */
        .import-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-family: 'Geist Mono', monospace;
            font-weight: 600;
        }
        
        .import-badge.critical {
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-red);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .import-badge.high {
            background: rgba(249, 115, 22, 0.15);
            color: var(--accent-orange);
            border: 1px solid rgba(249, 115, 22, 0.3);
        }
        
        .import-badge.medium {
            background: rgba(245, 158, 11, 0.15);
            color: var(--accent-yellow);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .import-badge.low {
            background: rgba(16, 185, 129, 0.15);
            color: var(--accent-green);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        /* Manufacturer Cards */
        .manufacturer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 16px;
        }
        
        .manufacturer-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            transition: border-color 0.15s;
        }
        
        .manufacturer-card:hover {
            border-color: var(--border-hover);
        }
        
        .mfg-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .mfg-name {
            font-size: 16px;
            font-weight: 600;
        }
        
        .mfg-name a {
            color: var(--text-primary);
            text-decoration: none;
        }
        
        .mfg-name a:hover {
            color: var(--accent-blue);
        }
        
        .mfg-share {
            font-size: 14px;
            font-weight: 600;
            font-family: 'Geist Mono', monospace;
            color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.1);
            padding: 4px 10px;
            border-radius: 4px;
        }
        
        .mfg-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }
        
        .mfg-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }
        
        .mfg-tag {
            font-size: 10px;
            color: var(--text-secondary);
            background: var(--bg-tertiary);
            padding: 3px 8px;
            border-radius: 4px;
        }
        
        .mfg-lead-time {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            font-size: 13px;
        }
        
        .mfg-lead-value {
            font-weight: 600;
            font-family: 'Geist Mono', monospace;
            color: var(--accent-yellow);
        }
        
        /* Bottleneck Cards */
        .bottleneck-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
        }
        
        .bottleneck-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }
        
        .bottleneck-severity {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            gap: 3px;
        }
        
        .severity-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--bg-tertiary);
        }
        
        .severity-dot.active {
            background: var(--accent-red);
        }
        
        .severity-dot.warning {
            background: var(--accent-yellow);
        }
        
        .bottleneck-name {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
            padding-right: 80px;
        }
        
        .bottleneck-desc {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Two Column Layout */
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        @media (max-width: 1200px) {
            .two-col {
                grid-template-columns: 1fr;
            }
        }
        
        /* Material Flow Cards */
        .material-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
        }
        
        .material-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .material-name {
            font-size: 18px;
            font-weight: 600;
        }
        
        .material-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .material-stat {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }
        
        .material-stat-value {
            font-size: 20px;
            font-weight: 600;
            font-family: 'Geist Mono', monospace;
            color: var(--accent-blue);
        }
        
        .material-stat-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* Supplier List */
        .supplier-list {
            border-top: 1px solid var(--border);
            padding-top: 12px;
        }
        
        .supplier-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .supplier-row:last-child {
            border-bottom: none;
        }
        
        .supplier-name {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .supplier-country {
            font-size: 11px;
            color: var(--text-muted);
        }
        
        .supplier-share {
            font-size: 13px;
            font-weight: 600;
            font-family: 'Geist Mono', monospace;
            color: var(--accent-cyan);
        }
        
        /* Info Boxes */
        .info-box {
            background: var(--bg-tertiary);
            border-radius: 6px;
            padding: 16px;
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 16px;
        }
        
        .info-box strong {
            color: var(--text-primary);
        }
        
        .info-box.warning {
            border-left: 3px solid var(--accent-yellow);
        }
        
        .info-box.danger {
            border-left: 3px solid var(--accent-red);
        }
        
        /* Category Tabs */
        .category-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .category-tab {
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.15s;
        }
        
        .category-tab:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }
        
        .category-tab.active {
            color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .sidebar {
                display: none;
            }
            
            .content {
                padding: 16px;
            }
            
            .lead-time-row {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-hover);
        }
        
        /* Capacity Gap Visualization */
        .capacity-gap {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .capacity-bar-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .capacity-label {
            width: 100px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .capacity-bar {
            flex: 1;
            height: 24px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .capacity-fill {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            font-size: 11px;
            font-family: 'Geist Mono', monospace;
            color: white;
        }
        
        .capacity-demand {
            background: var(--accent-blue);
        }
        
        .capacity-supply {
            background: var(--accent-green);
        }
        
        .capacity-gap-indicator {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                45deg,
                rgba(239, 68, 68, 0.3),
                rgba(239, 68, 68, 0.3) 5px,
                transparent 5px,
                transparent 10px
            );
        }
    </style>
</head>
<body>
    <!-- Header Bar -->
    <header class="header-bar">
        <div class="logo">
            <div class="logo-icon">⚡</div>
            <div class="logo-text">Grid Supply Chain Intelligence <span>by Prospector Labs</span></div>
        </div>
        <div class="header-right">
            <div class="live-indicator">
                <div class="live-dot"></div>
                <span>Live Data — February 2026</span>
            </div>
        </div>
    </header>
    
    <div class="main-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="nav-section">
                <div class="nav-section-title">Overview</div>
                <div class="nav-item active" data-tab="overview">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                    Market Overview
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Equipment Categories</div>
                <div class="nav-item" data-tab="transformers">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v10M1 12h6m6 0h10"/></svg>
                    Transformers
                </div>
                <div class="nav-item" data-tab="switchgear">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                    Switchgear
                </div>
                <div class="nav-item" data-tab="cables">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/></svg>
                    Cables & Conductors
                </div>
                <div class="nav-item" data-tab="components">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/><line x1="4.93" y1="4.93" x2="9.17" y2="9.17"/><line x1="14.83" y1="14.83" x2="19.07" y2="19.07"/><line x1="14.83" y1="9.17" x2="19.07" y2="4.93"/><line x1="4.93" y1="19.07" x2="9.17" y2="14.83"/></svg>
                    Components
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Supply Chain</div>
                <div class="nav-item" data-tab="materials">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/></svg>
                    Materials
                </div>
                <div class="nav-item" data-tab="manufacturers">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 21h18M3 7v1a3 3 0 006 0V7m0 1a3 3 0 006 0V7m0 1a3 3 0 006 0V7H3l2-4h14l2 4M5 21V10.87M19 21V10.87"/></svg>
                    Manufacturers
                </div>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="content">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <div class="section-header">
                    <h1 class="section-title">US Grid Equipment Market</h1>
                    <p class="section-subtitle">Comprehensive supply chain intelligence for electrical grid infrastructure</p>
                </div>
                
                <!-- Key Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value blue">$85B</div>
                        <div class="stat-label">Total US Market (2025)</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value yellow">36</div>
                        <div class="stat-label">Months — LPT Lead Time</div>
                        <div class="stat-change up">↑ 140% vs pre-2020</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value red">70%</div>
                        <div class="stat-label">GOES Import Dependency</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value green">2,600</div>
                        <div class="stat-label">GW in Interconnection Queue</div>
                    </div>
                    <div class="stat-card purple">
                        <div class="stat-value" style="color: var(--accent-purple)">6</div>
                        <div class="stat-label">US LPT Manufacturing Sites</div>
                    </div>
                </div>
                
                <!-- Market Flow Sankey -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">US Grid Equipment Market Flow</div>
                            <div class="chart-subtitle">Equipment categories → Subcategories → Import vs Domestic ($B)</div>
                        </div>
                        <div class="chart-legend">
                            <div class="legend-item"><div class="legend-dot" style="background: var(--accent-blue)"></div>Domestic</div>
                            <div class="legend-item"><div class="legend-dot" style="background: var(--accent-orange)"></div>Imported</div>
                        </div>
                    </div>
                    <div id="market-sankey" class="sankey-container" style="height: 450px;"></div>
                </div>
                
                <!-- Two Column: Import Dependency + Bottlenecks -->
                <div class="two-col">
                    <!-- Import Dependency -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">US Import Dependency by Category</div>
                                <div class="chart-subtitle">Percentage of equipment sourced from imports</div>
                            </div>
                        </div>
                        <div id="import-treemap" class="treemap-container"></div>
                    </div>
                    
                    <!-- Capacity Gap -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">LPT Capacity Gap</div>
                                <div class="chart-subtitle">US demand vs domestic manufacturing capacity</div>
                            </div>
                        </div>
                        <div class="capacity-gap">
                            <div class="capacity-bar-container">
                                <div class="capacity-label">Annual Demand</div>
                                <div class="capacity-bar">
                                    <div class="capacity-fill capacity-demand" style="width: 100%;">200 units</div>
                                </div>
                            </div>
                            <div class="capacity-bar-container">
                                <div class="capacity-label">US Capacity</div>
                                <div class="capacity-bar">
                                    <div class="capacity-fill capacity-supply" style="width: 75%;">150 units</div>
                                    <div class="capacity-gap-indicator" style="width: 25%;"></div>
                                </div>
                            </div>
                            <div class="info-box warning" style="margin-top: 16px;">
                                <strong>50 unit gap</strong> — Must be filled by imports from Germany, Japan, South Korea, and Mexico. New Hyundai facility (AL) adds 24 units/year in 2025.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Critical Bottlenecks -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Critical Supply Chain Bottlenecks</div>
                            <div class="chart-subtitle">Key constraints limiting US grid equipment production</div>
                        </div>
                    </div>
                    <div class="bottleneck-grid">
                        <div class="bottleneck-card">
                            <div class="bottleneck-severity">
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                            </div>
                            <div class="bottleneck-name">GOES Steel</div>
                            <div class="bottleneck-desc">Grain-oriented electrical steel for transformer cores. US 70% import dependent. Only one US producer (Cleveland-Cliffs). 18-24 month lead for new capacity.</div>
                        </div>
                        <div class="bottleneck-card">
                            <div class="bottleneck-severity">
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                            </div>
                            <div class="bottleneck-name">LPT Manufacturing Capacity</div>
                            <div class="bottleneck-desc">Only 6 US facilities can produce large power transformers. New facilities require $100M+ and 2+ years to build. 150 units/year domestic capacity vs 200+ demand.</div>
                        </div>
                        <div class="bottleneck-card">
                            <div class="bottleneck-severity">
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot"></div>
                            </div>
                            <div class="bottleneck-name">HV Bushings</div>
                            <div class="bottleneck-desc">Critical transformer component. ~60% imported to US. Limited qualified global suppliers. Long qualification process for new suppliers.</div>
                        </div>
                        <div class="bottleneck-card">
                            <div class="bottleneck-severity">
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot active"></div>
                                <div class="severity-dot"></div>
                            </div>
                            <div class="bottleneck-name">Skilled Labor</div>
                            <div class="bottleneck-desc">2-5 year training time for transformer manufacturing. 30% of workforce retiring in next decade. Limited training programs.</div>
                        </div>
                        <div class="bottleneck-card">
                            <div class="bottleneck-severity">
                                <div class="severity-dot warning"></div>
                                <div class="severity-dot warning"></div>
                                <div class="severity-dot warning"></div>
                                <div class="severity-dot"></div>
                                <div class="severity-dot"></div>
                            </div>
                            <div class="bottleneck-name">Copper Supply</div>
                            <div class="bottleneck-desc">Competition from EV and renewable sectors. Potential 5-10M ton supply gap by 2030. Prices up 10-20% YoY.</div>
                        </div>
                        <div class="bottleneck-card">
                            <div class="bottleneck-severity">
                                <div class="severity-dot warning"></div>
                                <div class="severity-dot warning"></div>
                                <div class="severity-dot warning"></div>
                                <div class="severity-dot"></div>
                                <div class="severity-dot"></div>
                            </div>
                            <div class="bottleneck-name">SF6 Regulations</div>
                            <div class="bottleneck-desc">EU F-gas phase-out. California restrictions. GWP of 23,500. Alternatives (g3, vacuum) still maturing for high voltage.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Transformers Tab -->
            <div id="transformers" class="tab-content">
                <div class="section-header">
                    <h1 class="section-title">Transformers</h1>
                    <p class="section-subtitle">Large power, generator step-up, and distribution transformer supply chain</p>
                </div>
                
                <!-- Sub-tabs -->
                <div class="category-tabs">
                    <button class="category-tab active" data-subtab="xfmr-overview">Overview</button>
                    <button class="category-tab" data-subtab="xfmr-lpt">Large Power (LPT)</button>
                    <button class="category-tab" data-subtab="xfmr-gsu">Generator Step-Up</button>
                    <button class="category-tab" data-subtab="xfmr-dist">Distribution</button>
                </div>
                
                <div id="xfmr-overview" class="subtab-content active">
                    <!-- Market Breakdown -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value blue">$28B</div>
                            <div class="stat-label">US Transformer Market</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value yellow">71%</div>
                            <div class="stat-label">Import Dependency</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">~200</div>
                            <div class="stat-label">LPT Units/Year (US Demand)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">~500K</div>
                            <div class="stat-label">Distribution Units/Year</div>
                        </div>
                    </div>
                    
                    <!-- Transformer Supply Flow Sankey -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">LPT Supply Flow</div>
                                <div class="chart-subtitle">Global production → US imports → End users</div>
                            </div>
                        </div>
                        <div id="transformer-sankey" class="sankey-container" style="height: 400px;"></div>
                    </div>
                    
                    <!-- Lead Times Comparison -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Lead Times: Historical Comparison</div>
                                <div class="chart-subtitle">Pre-2020 → Peak 2023 → Current (months)</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item"><div class="legend-dot" style="background: var(--text-muted)"></div>Pre-2020</div>
                                <div class="legend-item"><div class="legend-dot" style="background: var(--accent-red)"></div>Peak 2023</div>
                                <div class="legend-item"><div class="legend-dot" style="background: var(--accent-blue)"></div>Current</div>
                            </div>
                        </div>
                        <div class="timeline-bar-container">
                            <div class="timeline-bar-row">
                                <div class="lead-time-label">Distribution<small>&lt;5 MVA</small></div>
                                <div class="timeline-bar-group">
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 30px; background: var(--text-muted);">3</div>
                                        <span class="timeline-period-label">Pre-2020</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 180px; background: var(--accent-red);">18</div>
                                        <span class="timeline-period-label">Peak 2023</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 110px; background: var(--accent-blue);">11</div>
                                        <span class="timeline-period-label">Current</span>
                                    </div>
                                </div>
                            </div>
                            <div class="timeline-bar-row">
                                <div class="lead-time-label">Medium Power<small>10-100 MVA</small></div>
                                <div class="timeline-bar-group">
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 90px; background: var(--text-muted);">9</div>
                                        <span class="timeline-period-label">Pre-2020</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 300px; background: var(--accent-red);">30</div>
                                        <span class="timeline-period-label">Peak 2023</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 220px; background: var(--accent-blue);">22</div>
                                        <span class="timeline-period-label">Current</span>
                                    </div>
                                </div>
                            </div>
                            <div class="timeline-bar-row">
                                <div class="lead-time-label">Large Power (LPT)<small>100-400 MVA</small></div>
                                <div class="timeline-bar-group">
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 150px; background: var(--text-muted);">15</div>
                                        <span class="timeline-period-label">Pre-2020</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 480px; background: var(--accent-red);">48</div>
                                        <span class="timeline-period-label">Peak 2023</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 360px; background: var(--accent-blue);">36</div>
                                        <span class="timeline-period-label">Current</span>
                                    </div>
                                </div>
                            </div>
                            <div class="timeline-bar-row">
                                <div class="lead-time-label">GSU<small>200-1000+ MVA</small></div>
                                <div class="timeline-bar-group">
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 210px; background: var(--text-muted);">21</div>
                                        <span class="timeline-period-label">Pre-2020</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 600px; background: var(--accent-red);">60</div>
                                        <span class="timeline-period-label">Peak 2023</span>
                                    </div>
                                    <div class="timeline-bar-wrapper">
                                        <div class="timeline-bar" style="width: 420px; background: var(--accent-blue);">42</div>
                                        <span class="timeline-period-label">Current</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Lead Times by Manufacturer -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">LPT Lead Times by Manufacturer</div>
                                <div class="chart-subtitle">Current quoted lead times (100+ MVA units)</div>
                            </div>
                        </div>
                        <div id="mfg-lead-times" class="lead-time-chart"></div>
                    </div>
                </div>
                
                <div id="xfmr-lpt" class="subtab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value blue">$3.2B</div>
                            <div class="stat-label">US LPT Market</div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-value red">75%</div>
                            <div class="stat-label">Imported</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value yellow">36</div>
                            <div class="stat-label">Months Lead Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">6</div>
                            <div class="stat-label">US Manufacturing Sites</div>
                        </div>
                    </div>
                    
                    <div class="info-box danger">
                        <strong>Critical Infrastructure:</strong> Large power transformers (100+ MVA) are custom-engineered, weigh 100-400+ tons, and cannot be easily stockpiled. Failure of a single LPT can cause widespread outages lasting months. The US has limited surge capacity for emergency replacement.
                    </div>
                </div>
                
                <div id="xfmr-gsu" class="subtab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value blue">$2.1B</div>
                            <div class="stat-label">US GSU Market</div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-value red">81%</div>
                            <div class="stat-label">Imported</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value yellow">42</div>
                            <div class="stat-label">Months Lead Time</div>
                        </div>
                    </div>
                    
                    <div class="info-box warning">
                        <strong>Longest Lead Item:</strong> Generator Step-Up transformers connect power plants to the grid. They are the critical path item for new nuclear, gas, and large renewable projects. Planning horizons of 4-5 years are now required.
                    </div>
                </div>
                
                <div id="xfmr-dist" class="subtab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value blue">$17.9B</div>
                            <div class="stat-label">US Distribution Market</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value yellow">70%</div>
                            <div class="stat-label">Imported</div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-value green">11</div>
                            <div class="stat-label">Months Lead Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">~500K</div>
                            <div class="stat-label">Units/Year</div>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <strong>Improving:</strong> Distribution transformer lead times have improved significantly from peak of 18 months in 2023. Howard Industries (MS) and others have expanded capacity. Still elevated vs pre-2020 norm of 3 months.
                    </div>
                </div>
            </div>
            
            <!-- Switchgear Tab -->
            <div id="switchgear" class="tab-content">
                <div class="section-header">
                    <h1 class="section-title">Switchgear</h1>
                    <p class="section-subtitle">Gas-insulated, air-insulated switchgear and circuit breakers</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value blue">$22B</div>
                        <div class="stat-label">US Switchgear Market</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value yellow">73%</div>
                        <div class="stat-label">Import Dependency</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">24</div>
                        <div class="stat-label">Months — GIS Lead Time</div>
                    </div>
                </div>
                
                <!-- GIS vs AIS Breakdown -->
                <div class="two-col">
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Market Breakdown</div>
                                <div class="chart-subtitle">Switchgear subcategories</div>
                            </div>
                        </div>
                        <div id="switchgear-treemap" class="treemap-container"></div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">SF6 Alternatives Trend</div>
                                <div class="chart-subtitle">Phase-out driven by environmental regulations</div>
                            </div>
                        </div>
                        <div style="padding: 16px 0;">
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 13px;">g3 (GE Vernova)</span>
                                    <span class="import-badge low">GWP &lt;1</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-muted);">Fluoronitrile mixture. Commercial deployment. Up to 420 kV.</div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 13px;">Clean Air (Hitachi Energy)</span>
                                    <span class="import-badge low">GWP &lt;1</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-muted);">CO2/O2 mixture with fluoronitrile. Commercial. Up to 420 kV.</div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 13px;">Vacuum Technology</span>
                                    <span class="import-badge low">GWP 0</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-muted);">Proven up to 145 kV. Expanding to higher voltages. No gas required.</div>
                            </div>
                            <div class="info-box warning">
                                <strong>SF6 GWP: 23,500</strong> — EU F-gas Regulation targeting phase-out. California restrictions in effect. Reclamation requirements increasing costs.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Lead Times -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Switchgear Lead Times</div>
                            <div class="chart-subtitle">Current quoted lead times by category</div>
                        </div>
                    </div>
                    <div class="lead-time-chart">
                        <div class="lead-time-row">
                            <div class="lead-time-label">GIS (145-550 kV)</div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment current" style="width: 60%;"><span>24 mo</span></div>
                            </div>
                            <div class="lead-time-value">18-30</div>
                        </div>
                        <div class="lead-time-row">
                            <div class="lead-time-label">AIS (145-550 kV)</div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment current" style="width: 45%;"><span>18 mo</span></div>
                            </div>
                            <div class="lead-time-value">12-24</div>
                        </div>
                        <div class="lead-time-row">
                            <div class="lead-time-label">HV Circuit Breakers</div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment current" style="width: 50%;"><span>20 mo</span></div>
                            </div>
                            <div class="lead-time-value">14-26</div>
                        </div>
                        <div class="lead-time-row">
                            <div class="lead-time-label">Generator CB</div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment current" style="width: 55%;"><span>22 mo</span></div>
                            </div>
                            <div class="lead-time-value">16-28</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Cables Tab -->
            <div id="cables" class="tab-content">
                <div class="section-header">
                    <h1 class="section-title">Cables & Conductors</h1>
                    <p class="section-subtitle">HVDC, XLPE underground cables, and overhead conductors</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value blue">$18B</div>
                        <div class="stat-label">US Cables Market</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value yellow">33%</div>
                        <div class="stat-label">Import Dependency</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value red">42</div>
                        <div class="stat-label">Months — HVDC Lead Time</div>
                    </div>
                </div>
                
                <div class="two-col">
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Cable Types by Import Dependency</div>
                            </div>
                        </div>
                        <div style="padding: 16px 0;">
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-size: 14px; font-weight: 500;">HVDC Submarine</span>
                                    <span class="import-badge critical">90% Import</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-muted);">$4.2B market. Only 4 global manufacturers. Installation vessel constraints.</div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-size: 14px; font-weight: 500;">XLPE Underground</span>
                                    <span class="import-badge medium">40% Import</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-muted);">$5.8B market. Growing domestic production. Prysmian, Nexans, Southwire.</div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-size: 14px; font-weight: 500;">Overhead Conductors</span>
                                    <span class="import-badge low">0% Import</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-muted);">$8.0B market. Fully domestic production. ACSR, HTLS, carbon core.</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">HVDC Cable Producers</div>
                                <div class="chart-subtitle">Global market share (submarine)</div>
                            </div>
                        </div>
                        <div id="hvdc-treemap" class="treemap-container"></div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Cable Lead Times</div>
                        </div>
                    </div>
                    <div class="lead-time-chart">
                        <div class="lead-time-row">
                            <div class="lead-time-label">HVDC Submarine<small>320-525 kV DC</small></div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment" style="width: 88%; background: var(--accent-red);"><span>42 mo</span></div>
                            </div>
                            <div class="lead-time-value">32-52</div>
                        </div>
                        <div class="lead-time-row">
                            <div class="lead-time-label">Underground XLPE<small>138-345 kV</small></div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment current" style="width: 45%;"><span>18 mo</span></div>
                            </div>
                            <div class="lead-time-value">12-24</div>
                        </div>
                        <div class="lead-time-row">
                            <div class="lead-time-label">Overhead Conductors<small>ACSR/HTLS</small></div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment" style="width: 20%; background: var(--accent-green);"><span>8 mo</span></div>
                            </div>
                            <div class="lead-time-value">4-12</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Components Tab -->
            <div id="components" class="tab-content">
                <div class="section-header">
                    <h1 class="section-title">Substation Components</h1>
                    <p class="section-subtitle">HV bushings, insulators, and surge arresters</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value blue">$12B</div>
                        <div class="stat-label">US Components Market</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value yellow">67%</div>
                        <div class="stat-label">Import Dependency</div>
                    </div>
                </div>
                
                <!-- HV Bushings -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">HV Bushings</div>
                            <div class="chart-subtitle">Critical transformer component — $2.5B market</div>
                        </div>
                        <span class="import-badge high">60% Import</span>
                    </div>
                    <div class="two-col">
                        <div id="bushing-sankey" class="sankey-container" style="height: 250px;"></div>
                        <div>
                            <div class="lead-time-chart">
                                <div class="lead-time-row">
                                    <div class="lead-time-label">HV Bushings<small>230+ kV RIP/RIS</small></div>
                                    <div class="lead-time-track">
                                        <div class="lead-time-segment" style="width: 45%; background: var(--accent-orange);"><span>18 mo</span></div>
                                    </div>
                                    <div class="lead-time-value">12-24</div>
                                </div>
                                <div class="lead-time-row">
                                    <div class="lead-time-label">EHV Bushings<small>500+ kV</small></div>
                                    <div class="lead-time-track">
                                        <div class="lead-time-segment" style="width: 60%; background: var(--accent-red);"><span>24 mo</span></div>
                                    </div>
                                    <div class="lead-time-value">16-30</div>
                                </div>
                            </div>
                            <div class="info-box warning" style="margin-top: 16px;">
                                <strong>Critical Bottleneck:</strong> Limited qualified global suppliers. Long qualification process (2+ years). Bushing failures are a leading cause of transformer outages.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Insulators -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Insulators</div>
                            <div class="chart-subtitle">Porcelain and composite insulators — $1.8B market</div>
                        </div>
                        <span class="import-badge high">72% Import</span>
                    </div>
                    <div class="two-col">
                        <div id="insulator-sankey" class="sankey-container" style="height: 250px;"></div>
                        <div>
                            <div class="lead-time-chart">
                                <div class="lead-time-row">
                                    <div class="lead-time-label">Station Post<small>345-765 kV</small></div>
                                    <div class="lead-time-track">
                                        <div class="lead-time-segment current" style="width: 35%;"><span>14 mo</span></div>
                                    </div>
                                    <div class="lead-time-value">8-18</div>
                                </div>
                                <div class="lead-time-row">
                                    <div class="lead-time-label">Composite Line<small>Polymer</small></div>
                                    <div class="lead-time-track">
                                        <div class="lead-time-segment" style="width: 30%; background: var(--accent-green);"><span>12 mo</span></div>
                                    </div>
                                    <div class="lead-time-value">6-16</div>
                                </div>
                            </div>
                            <div class="info-box">
                                <strong>Trend:</strong> Polymer/composite insulators gaining share over porcelain. Lighter weight, vandal resistant. China dominates porcelain production.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Surge Arresters -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Surge Arresters</div>
                            <div class="chart-subtitle">Overvoltage protection — $1.2B market</div>
                        </div>
                        <span class="import-badge high">67% Import</span>
                    </div>
                    <div class="lead-time-chart">
                        <div class="lead-time-row">
                            <div class="lead-time-label">Station Class<small>Up to 1200 kV</small></div>
                            <div class="lead-time-track">
                                <div class="lead-time-segment current" style="width: 35%;"><span>14 mo</span></div>
                            </div>
                            <div class="lead-time-value">8-16</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Materials Tab -->
            <div id="materials" class="tab-content">
                <div class="section-header">
                    <h1 class="section-title">Materials Supply Chain</h1>
                    <p class="section-subtitle">Critical raw materials for grid infrastructure manufacturing</p>
                </div>
                
                <!-- GOES -->
                <div class="material-card">
                    <div class="material-header">
                        <div class="material-name">GOES (Grain-Oriented Electrical Steel)</div>
                        <span class="import-badge critical">70% Import</span>
                    </div>
                    <div class="material-stats">
                        <div class="material-stat">
                            <div class="material-stat-value">250K</div>
                            <div class="material-stat-label">Tons/Year (US)</div>
                        </div>
                        <div class="material-stat">
                            <div class="material-stat-value">$3.5-4.5K</div>
                            <div class="material-stat-label">Per Ton</div>
                        </div>
                        <div class="material-stat">
                            <div class="material-stat-value">1</div>
                            <div class="material-stat-label">US Producer</div>
                        </div>
                    </div>
                    <div id="goes-sankey" class="sankey-container" style="height: 200px;"></div>
                    <div class="supplier-list">
                        <div class="supplier-row">
                            <div><span class="supplier-name">Nippon Steel</span> <span class="supplier-country">Japan</span></div>
                            <div class="supplier-share">~25%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">Baowu Steel</span> <span class="supplier-country">China</span></div>
                            <div class="supplier-share">~20%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">JFE Steel</span> <span class="supplier-country">Japan</span></div>
                            <div class="supplier-share">~15%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">POSCO</span> <span class="supplier-country">South Korea</span></div>
                            <div class="supplier-share">~12%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">Cleveland-Cliffs</span> <span class="supplier-country">USA 🇺🇸</span></div>
                            <div class="supplier-share">~8%</div>
                        </div>
                    </div>
                    <div class="info-box danger" style="margin-top: 16px;">
                        <strong>Single Point of Failure:</strong> Cleveland-Cliffs (Butler, PA & Zanesville, OH) is the only US GOES producer. Section 232 tariffs (25%) apply to imports. Capacity expansion underway but takes 18-24 months.
                    </div>
                </div>
                
                <!-- Copper -->
                <div class="material-card">
                    <div class="material-header">
                        <div class="material-name">Copper (Winding & Conductor Grade)</div>
                        <span class="import-badge medium">Medium Risk</span>
                    </div>
                    <div class="material-stats">
                        <div class="material-stat">
                            <div class="material-stat-value">2.8M</div>
                            <div class="material-stat-label">Tons/Year (US Grid)</div>
                        </div>
                        <div class="material-stat">
                            <div class="material-stat-value">$8.5-9.5K</div>
                            <div class="material-stat-label">Per Ton (LME)</div>
                        </div>
                        <div class="material-stat">
                            <div class="material-stat-value" style="color: var(--accent-red);">↑15%</div>
                            <div class="material-stat-label">YoY Price</div>
                        </div>
                    </div>
                    <div class="supplier-list">
                        <div class="supplier-row">
                            <div><span class="supplier-name">Chile</span> <span class="supplier-country">(Codelco)</span></div>
                            <div class="supplier-share">27% global</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">Peru</span></div>
                            <div class="supplier-share">10% global</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">USA</span> <span class="supplier-country">(Freeport-McMoRan)</span></div>
                            <div class="supplier-share">6% global</div>
                        </div>
                    </div>
                    <div class="info-box warning" style="margin-top: 16px;">
                        <strong>Competition Intensifying:</strong> EV sector, data centers, and renewables all competing for copper. Potential 5-10M ton supply gap by 2030. Mining permits increasingly difficult.
                    </div>
                </div>
                
                <!-- SF6 -->
                <div class="material-card">
                    <div class="material-header">
                        <div class="material-name">SF6 (Sulfur Hexafluoride)</div>
                        <span class="import-badge high">Regulatory Risk</span>
                    </div>
                    <div class="material-stats">
                        <div class="material-stat">
                            <div class="material-stat-value">9K</div>
                            <div class="material-stat-label">Tons/Year (US)</div>
                        </div>
                        <div class="material-stat">
                            <div class="material-stat-value">$15-25</div>
                            <div class="material-stat-label">Per kg</div>
                        </div>
                        <div class="material-stat">
                            <div class="material-stat-value" style="color: var(--accent-red);">23,500</div>
                            <div class="material-stat-label">GWP</div>
                        </div>
                    </div>
                    <div class="supplier-list">
                        <div class="supplier-row">
                            <div><span class="supplier-name">Chinese Producers</span></div>
                            <div class="supplier-share">~30%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">Solvay</span> <span class="supplier-country">Belgium</span></div>
                            <div class="supplier-share">~20%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">Honeywell</span> <span class="supplier-country">USA 🇺🇸</span></div>
                            <div class="supplier-share">~15%</div>
                        </div>
                        <div class="supplier-row">
                            <div><span class="supplier-name">Linde</span> <span class="supplier-country">Germany</span></div>
                            <div class="supplier-share">~15%</div>
                        </div>
                    </div>
                    <div class="info-box warning" style="margin-top: 16px;">
                        <strong>Phase-Out Underway:</strong> EU F-gas Regulation targeting elimination. California restrictions active. Price up 20-30% YoY. Alternatives (g3, vacuum) gaining traction but not yet proven at highest voltages.
                    </div>
                </div>
            </div>
            
            <!-- Manufacturers Tab -->
            <div id="manufacturers" class="tab-content">
                <div class="section-header">
                    <h1 class="section-title">Manufacturers</h1>
                    <p class="section-subtitle">Major grid equipment manufacturers serving the US market</p>
                </div>
                
                <!-- Market Share Treemap -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">US LPT Market Share</div>
                            <div class="chart-subtitle">Large power transformer manufacturers</div>
                        </div>
                    </div>
                    <div id="lpt-market-treemap" class="treemap-container" style="height: 250px;"></div>
                </div>
                
                <!-- Manufacturer Cards -->
                <div class="manufacturer-grid" id="manufacturer-grid">
                    <!-- Populated by JS -->
                </div>
            </div>
        </main>
    </div>
    
    <script>
        // Data
        const marketFlows = {
            categories: [
                {name: "Transformers", value: 28, domestic: 8, imported: 20},
                {name: "Switchgear", value: 22, domestic: 6, imported: 16},
                {name: "Cables", value: 18, domestic: 12, imported: 6},
                {name: "Components", value: 12, domestic: 4, imported: 8},
                {name: "Materials", value: 5, domestic: 1.5, imported: 3.5}
            ]
        };
        
        const manufacturerLeadTimes = [
            {name: "Hyundai Electric", location: "🇰🇷 South Korea + AL (2025)", min: 26, max: 36, avg: 31},
            {name: "Virginia Transformer", location: "🇺🇸 Roanoke, VA", min: 26, max: 36, avg: 31},
            {name: "Prolec GE", location: "🇲🇽 Monterrey", min: 28, max: 38, avg: 33},
            {name: "SPX Transformer", location: "🇺🇸 Waukesha, WI", min: 28, max: 38, avg: 33},
            {name: "Siemens Energy", location: "🇩🇪 Germany", min: 28, max: 40, avg: 34},
            {name: "GE Vernova", location: "🇺🇸 Charleroi, PA", min: 30, max: 42, avg: 36},
            {name: "Hitachi Energy", location: "🇨🇭 Switzerland + MO", min: 30, max: 42, avg: 36}
        ];
        
        const manufacturers = [
            {
                name: "Hitachi Energy",
                share: "20%",
                hq: "Switzerland",
                usPlants: "Jefferson City MO, South Boston VA, Bland VA",
                products: ["LPT", "Distribution", "HVDC", "GIS"],
                leadTime: "30-42 months",
                notes: "Largest global player. Strong HVDC position."
            },
            {
                name: "Siemens Energy",
                share: "15%",
                hq: "Germany",
                usPlants: "Charlotte NC (service), Wendell NC",
                products: ["LPT", "GIS", "Circuit Breakers"],
                leadTime: "28-40 months",
                notes: "GIS market leader. Limited US LPT mfg."
            },
            {
                name: "GE Vernova",
                share: "14%",
                hq: "USA",
                usPlants: "Charleroi PA, Clearwater FL",
                products: ["LPT", "GIS", "HVDC", "Grid Automation"],
                leadTime: "30-42 months",
                notes: "Spun off 2024. Owns Prolec GE (Mexico)."
            },
            {
                name: "Virginia Transformer",
                share: "8%",
                hq: "USA",
                usPlants: "Roanoke VA, Pocatello ID, Rincon GA",
                products: ["LPT", "Medium Power", "Distribution"],
                leadTime: "26-36 months",
                notes: "Largest private US manufacturer. 100% domestic."
            },
            {
                name: "Hyundai Electric",
                share: "6%",
                hq: "South Korea",
                usPlants: "Montgomery AL (2025)",
                products: ["LPT", "Distribution", "GIS"],
                leadTime: "26-36 months",
                notes: "New US plant adds 24 units/year capacity."
            },
            {
                name: "Howard Industries",
                share: "20% (dist)",
                hq: "USA",
                usPlants: "Laurel MS, Ellisville MS",
                products: ["Distribution", "Pad-Mount"],
                leadTime: "8-12 months",
                notes: "Largest US distribution transformer mfg. Employee-owned."
            }
        ];
        
        const lptMarketShare = [
            {name: "Hitachi", value: 20, color: "#3b82f6"},
            {name: "Siemens", value: 15, color: "#22d3ee"},
            {name: "GE Vernova", value: 14, color: "#10b981"},
            {name: "Prolec GE", value: 10, color: "#f59e0b"},
            {name: "Virginia", value: 8, color: "#f97316"},
            {name: "Toshiba", value: 8, color: "#a855f7"},
            {name: "Hyundai", value: 6, color: "#ec4899"},
            {name: "Mitsubishi", value: 5, color: "#6366f1"},
            {name: "SPX", value: 3, color: "#64748b"},
            {name: "Others", value: 11, color: "#374151"}
        ];
        
        const switchgearMarket = [
            {name: "GIS (145+ kV)", value: 8.5, color: "#3b82f6"},
            {name: "AIS (145+ kV)", value: 5.2, color: "#22d3ee"},
            {name: "HV Breakers", value: 4.8, color: "#10b981"},
            {name: "MV Switchgear", value: 3.5, color: "#f59e0b"}
        ];
        
        const hvdcProducers = [
            {name: "Prysmian (IT)", value: 35, color: "#3b82f6"},
            {name: "Nexans (FR)", value: 30, color: "#22d3ee"},
            {name: "NKT (DK)", value: 20, color: "#10b981"},
            {name: "Sumitomo (JP)", value: 10, color: "#f59e0b"},
            {name: "Other", value: 5, color: "#64748b"}
        ];
        
        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
                item.classList.add('active');
                document.getElementById(item.dataset.tab).classList.add('active');
            });
        });
        
        // Sub-tabs
        document.querySelectorAll('.category-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const parent = tab.closest('.tab-content');
                parent.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                parent.querySelectorAll('.subtab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                parent.querySelector(`#${tab.dataset.subtab}`).classList.add('active');
            });
        });
        
        // Render Lead Times by Manufacturer
        function renderMfgLeadTimes() {
            const container = document.getElementById('mfg-lead-times');
            const maxTime = 48;
            
            manufacturerLeadTimes.forEach(mfg => {
                const row = document.createElement('div');
                row.className = 'lead-time-row';
                const width = (mfg.avg / maxTime) * 100;
                const color = mfg.avg <= 32 ? 'var(--accent-blue)' : mfg.avg <= 35 ? 'var(--accent-orange)' : 'var(--accent-red)';
                
                row.innerHTML = `
                    <div class="lead-time-label">${mfg.name}<small>${mfg.location}</small></div>
                    <div class="lead-time-track">
                        <div class="lead-time-segment" style="width: ${width}%; background: ${color};"><span>${mfg.min}-${mfg.max} mo</span></div>
                    </div>
                    <div class="lead-time-value">${mfg.avg}</div>
                `;
                container.appendChild(row);
            });
        }
        
        // Render Manufacturer Cards
        function renderManufacturerCards() {
            const container = document.getElementById('manufacturer-grid');
            
            manufacturers.forEach(mfg => {
                const card = document.createElement('div');
                card.className = 'manufacturer-card';
                
                card.innerHTML = `
                    <div class="mfg-header">
                        <div class="mfg-name">${mfg.name}</div>
                        <div class="mfg-share">${mfg.share}</div>
                    </div>
                    <div class="mfg-meta">
                        <span>HQ: ${mfg.hq}</span>
                    </div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 12px;">
                        <strong>US Plants:</strong> ${mfg.usPlants}
                    </div>
                    <div class="mfg-tags">
                        ${mfg.products.map(p => `<span class="mfg-tag">${p}</span>`).join('')}
                    </div>
                    <div class="mfg-lead-time">
                        <span>LPT Lead Time</span>
                        <span class="mfg-lead-value">${mfg.leadTime}</span>
                    </div>
                    <div style="font-size: 11px; color: var(--text-muted); margin-top: 12px;">${mfg.notes}</div>
                `;
                container.appendChild(card);
            });
        }
        
        // Treemap helper
        function renderTreemap(containerId, data, width, height) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            const svg = d3.select(`#${containerId}`)
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`);
            
            const root = d3.hierarchy({children: data})
                .sum(d => d.value);
            
            d3.treemap()
                .size([width, height])
                .padding(3)
                (root);
            
            const cells = svg.selectAll('g')
                .data(root.leaves())
                .join('g')
                .attr('transform', d => `translate(${d.x0},${d.y0})`);
            
            cells.append('rect')
                .attr('class', 'treemap-cell')
                .attr('width', d => d.x1 - d.x0)
                .attr('height', d => d.y1 - d.y0)
                .attr('fill', d => d.data.color)
                .attr('rx', 4);
            
            cells.append('text')
                .attr('class', 'treemap-label')
                .attr('x', 8)
                .attr('y', 20)
                .text(d => d.data.name)
                .style('font-weight', '600');
            
            cells.append('text')
                .attr('class', 'treemap-label')
                .attr('x', 8)
                .attr('y', 36)
                .text(d => `${d.data.value}%`)
                .style('font-family', 'Geist Mono, monospace')
                .style('opacity', 0.8);
        }
        
        // Market Flow Sankey
        function renderMarketSankey() {
            const container = document.getElementById('market-sankey');
            if (!container) return;
            
            const width = container.clientWidth || 900;
            const height = 450;
            
            const svg = d3.select('#market-sankey')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`);
            
            // Build nodes and links
            const nodes = [
                {name: "US Grid Market\n$85B"},
                {name: "Transformers\n$28B"},
                {name: "Switchgear\n$22B"},
                {name: "Cables\n$18B"},
                {name: "Components\n$12B"},
                {name: "Materials\n$5B"},
                {name: "Domestic\n$31.5B"},
                {name: "Imported\n$53.5B"}
            ];
            
            const links = [
                {source: 0, target: 1, value: 28},
                {source: 0, target: 2, value: 22},
                {source: 0, target: 3, value: 18},
                {source: 0, target: 4, value: 12},
                {source: 0, target: 5, value: 5},
                {source: 1, target: 6, value: 8},
                {source: 1, target: 7, value: 20},
                {source: 2, target: 6, value: 6},
                {source: 2, target: 7, value: 16},
                {source: 3, target: 6, value: 12},
                {source: 3, target: 7, value: 6},
                {source: 4, target: 6, value: 4},
                {source: 4, target: 7, value: 8},
                {source: 5, target: 6, value: 1.5},
                {source: 5, target: 7, value: 3.5}
            ];
            
            const sankey = d3.sankey()
                .nodeWidth(20)
                .nodePadding(24)
                .extent([[1, 1], [width - 1, height - 6]]);
            
            const {nodes: sankeyNodes, links: sankeyLinks} = sankey({
                nodes: nodes.map(d => ({...d})),
                links: links.map(d => ({...d}))
            });
            
            const colorScale = d3.scaleOrdinal()
                .domain(["US Grid Market", "Transformers", "Switchgear", "Cables", "Components", "Materials", "Domestic", "Imported"])
                .range(["#3b82f6", "#22d3ee", "#10b981", "#f59e0b", "#a855f7", "#ec4899", "#10b981", "#f97316"]);
            
            svg.append('g')
                .selectAll('path')
                .data(sankeyLinks)
                .join('path')
                .attr('class', 'sankey-link')
                .attr('d', d3.sankeyLinkHorizontal())
                .attr('stroke', d => d.target.name.includes('Domestic') ? '#10b981' : d.target.name.includes('Imported') ? '#f97316' : colorScale(d.source.name.split('\n')[0]))
                .attr('stroke-width', d => Math.max(1, d.width));
            
            const node = svg.append('g')
                .selectAll('g')
                .data(sankeyNodes)
                .join('g')
                .attr('class', 'sankey-node');
            
            node.append('rect')
                .attr('x', d => d.x0)
                .attr('y', d => d.y0)
                .attr('height', d => d.y1 - d.y0)
                .attr('width', d => d.x1 - d.x0)
                .attr('fill', d => colorScale(d.name.split('\n')[0]))
                .attr('rx', 3);
            
            node.append('text')
                .attr('x', d => d.x0 < width / 2 ? d.x1 + 8 : d.x0 - 8)
                .attr('y', d => (d.y1 + d.y0) / 2)
                .attr('dy', '0.35em')
                .attr('text-anchor', d => d.x0 < width / 2 ? 'start' : 'end')
                .text(d => d.name.split('\n')[0])
                .style('font-size', '12px')
                .style('fill', '#fafafa')
                .style('font-weight', '500');
            
            node.append('text')
                .attr('x', d => d.x0 < width / 2 ? d.x1 + 8 : d.x0 - 8)
                .attr('y', d => (d.y1 + d.y0) / 2 + 14)
                .attr('text-anchor', d => d.x0 < width / 2 ? 'start' : 'end')
                .text(d => d.name.split('\n')[1] || '')
                .style('font-size', '11px')
                .style('fill', '#6a6a6a')
                .style('font-family', 'Geist Mono, monospace');
        }
        
        // Transformer Supply Sankey
        function renderTransformerSankey() {
            const container = document.getElementById('transformer-sankey');
            if (!container) return;
            
            const width = container.clientWidth || 800;
            const height = 400;
            
            const svg = d3.select('#transformer-sankey')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`);
            
            const nodes = [
                {name: "USA Domestic"},
                {name: "Mexico"},
                {name: "Germany"},
                {name: "Japan"},
                {name: "South Korea"},
                {name: "LPT Pool"},
                {name: "IOUs"},
                {name: "Public Power"},
                {name: "Co-ops"},
                {name: "Industrial"},
                {name: "Renewables/IPP"}
            ];
            
            const links = [
                {source: 0, target: 5, value: 25},
                {source: 1, target: 5, value: 22},
                {source: 2, target: 5, value: 18},
                {source: 3, target: 5, value: 15},
                {source: 4, target: 5, value: 12},
                {source: 5, target: 6, value: 41},
                {source: 5, target: 7, value: 16},
                {source: 5, target: 8, value: 11},
                {source: 5, target: 9, value: 14},
                {source: 5, target: 10, value: 10}
            ];
            
            const sankey = d3.sankey()
                .nodeWidth(18)
                .nodePadding(20)
                .extent([[1, 1], [width - 1, height - 6]]);
            
            const {nodes: sankeyNodes, links: sankeyLinks} = sankey({
                nodes: nodes.map(d => ({...d})),
                links: links.map(d => ({...d}))
            });
            
            const colors = {
                "USA Domestic": "#10b981",
                "Mexico": "#f59e0b",
                "Germany": "#3b82f6",
                "Japan": "#ec4899",
                "South Korea": "#a855f7",
                "LPT Pool": "#64748b",
                "IOUs": "#22d3ee",
                "Public Power": "#22d3ee",
                "Co-ops": "#22d3ee",
                "Industrial": "#22d3ee",
                "Renewables/IPP": "#22d3ee"
            };
            
            svg.append('g')
                .selectAll('path')
                .data(sankeyLinks)
                .join('path')
                .attr('class', 'sankey-link')
                .attr('d', d3.sankeyLinkHorizontal())
                .attr('stroke', d => colors[d.source.name])
                .attr('stroke-width', d => Math.max(1, d.width));
            
            const node = svg.append('g')
                .selectAll('g')
                .data(sankeyNodes)
                .join('g')
                .attr('class', 'sankey-node');
            
            node.append('rect')
                .attr('x', d => d.x0)
                .attr('y', d => d.y0)
                .attr('height', d => d.y1 - d.y0)
                .attr('width', d => d.x1 - d.x0)
                .attr('fill', d => colors[d.name])
                .attr('rx', 3);
            
            node.append('text')
                .attr('x', d => d.x0 < width / 2 ? d.x1 + 8 : d.x0 - 8)
                .attr('y', d => (d.y1 + d.y0) / 2)
                .attr('dy', '0.35em')
                .attr('text-anchor', d => d.x0 < width / 2 ? 'start' : 'end')
                .text(d => d.name)
                .style('font-size', '12px')
                .style('fill', '#fafafa');
        }
        
        // Import Dependency Treemap
        function renderImportTreemap() {
            const data = [
                {name: "Transformers 71%", value: 71, color: "#ef4444"},
                {name: "Switchgear 73%", value: 73, color: "#f97316"},
                {name: "Components 67%", value: 67, color: "#f59e0b"},
                {name: "Materials 70%", value: 70, color: "#ef4444"},
                {name: "Cables 33%", value: 33, color: "#10b981"}
            ];
            renderTreemap('import-treemap', data, 500, 300);
        }
        
        // GOES Sankey
        function renderGoesSankey() {
            const container = document.getElementById('goes-sankey');
            if (!container) return;
            
            const width = container.clientWidth || 600;
            const height = 200;
            
            const svg = d3.select('#goes-sankey')
                .append('svg')
                .attr('width', '100%')
                .attr('height', height)
                .attr('viewBox', `0 0 ${width} ${height}`);
            
            const nodes = [
                {name: "Japan"},
                {name: "S. Korea"},
                {name: "USA"},
                {name: "Germany"},
                {name: "China"},
                {name: "US Transformers"}
            ];
            
            const links = [
                {source: 0, target: 5, value: 34},
                {source: 1, target: 5, value: 22},
                {source: 2, target: 5, value: 30},
                {source: 3, target: 5, value: 6},
                {source: 4, target: 5, value: 8}
            ];
            
            const sankey = d3.sankey()
                .nodeWidth(16)
                .nodePadding(12)
                .extent([[1, 1], [width - 1, height - 6]]);
            
            const {nodes: sankeyNodes, links: sankeyLinks} = sankey({
                nodes: nodes.map(d => ({...d})),
                links: links.map(d => ({...d}))
            });
            
            const colors = ["#ec4899", "#a855f7", "#10b981", "#3b82f6", "#f59e0b", "#64748b"];
            
            svg.append('g')
                .selectAll('path')
                .data(sankeyLinks)
                .join('path')
                .attr('class', 'sankey-link')
                .attr('d', d3.sankeyLinkHorizontal())
                .attr('stroke', (d, i) => colors[d.source.index])
                .attr('stroke-width', d => Math.max(1, d.width));
            
            const node = svg.append('g')
                .selectAll('g')
                .data(sankeyNodes)
                .join('g')
                .attr('class', 'sankey-node');
            
            node.append('rect')
                .attr('x', d => d.x0)
                .attr('y', d => d.y0)
                .attr('height', d => d.y1 - d.y0)
                .attr('width', d => d.x1 - d.x0)
                .attr('fill', (d, i) => colors[i])
                .attr('rx', 2);
            
            node.append('text')
                .attr('x', d => d.x0 < width / 2 ? d.x1 + 6 : d.x0 - 6)
                .attr('y', d => (d.y1 + d.y0) / 2)
                .attr('dy', '0.35em')
                .attr('text-anchor', d => d.x0 < width / 2 ? 'start' : 'end')
                .text(d => d.name)
                .style('font-size', '11px')
                .style('fill', '#fafafa');
        }
        
        // Component Sankeys
        function renderComponentSankeys() {
            // Bushing Sankey
            const bushingContainer = document.getElementById('bushing-sankey');
            if (bushingContainer) {
                const width = bushingContainer.clientWidth || 400;
                const height = 250;
                
                const svg = d3.select('#bushing-sankey')
                    .append('svg')
                    .attr('width', '100%')
                    .attr('height', height)
                    .attr('viewBox', `0 0 ${width} ${height}`);
                
                const nodes = [
                    {name: "USA"},
                    {name: "Germany"},
                    {name: "Switzerland"},
                    {name: "China"},
                    {name: "US Market"}
                ];
                
                const links = [
                    {source: 0, target: 4, value: 40},
                    {source: 1, target: 4, value: 25},
                    {source: 2, target: 4, value: 20},
                    {source: 3, target: 4, value: 10}
                ];
                
                const sankey = d3.sankey()
                    .nodeWidth(14)
                    .nodePadding(16)
                    .extent([[1, 1], [width - 1, height - 6]]);
                
                const {nodes: sankeyNodes, links: sankeyLinks} = sankey({
                    nodes: nodes.map(d => ({...d})),
                    links: links.map(d => ({...d}))
                });
                
                const colors = ["#10b981", "#3b82f6", "#a855f7", "#f59e0b", "#64748b"];
                
                svg.append('g')
                    .selectAll('path')
                    .data(sankeyLinks)
                    .join('path')
                    .attr('class', 'sankey-link')
                    .attr('d', d3.sankeyLinkHorizontal())
                    .attr('stroke', (d) => colors[d.source.index])
                    .attr('stroke-width', d => Math.max(1, d.width));
                
                const node = svg.append('g')
                    .selectAll('g')
                    .data(sankeyNodes)
                    .join('g')
                    .attr('class', 'sankey-node');
                
                node.append('rect')
                    .attr('x', d => d.x0)
                    .attr('y', d => d.y0)
                    .attr('height', d => d.y1 - d.y0)
                    .attr('width', d => d.x1 - d.x0)
                    .attr('fill', (d, i) => colors[i])
                    .attr('rx', 2);
                
                node.append('text')
                    .attr('x', d => d.x0 < width / 2 ? d.x1 + 6 : d.x0 - 6)
                    .attr('y', d => (d.y1 + d.y0) / 2)
                    .attr('dy', '0.35em')
                    .attr('text-anchor', d => d.x0 < width / 2 ? 'start' : 'end')
                    .text(d => d.name)
                    .style('font-size', '11px')
                    .style('fill', '#fafafa');
            }
            
            // Insulator Sankey
            const insulatorContainer = document.getElementById('insulator-sankey');
            if (insulatorContainer) {
                const width = insulatorContainer.clientWidth || 400;
                const height = 250;
                
                const svg = d3.select('#insulator-sankey')
                    .append('svg')
                    .attr('width', '100%')
                    .attr('height', height)
                    .attr('viewBox', `0 0 ${width} ${height}`);
                
                const nodes = [
                    {name: "China"},
                    {name: "Japan (NGK)"},
                    {name: "USA"},
                    {name: "France"},
                    {name: "US Market"}
                ];
                
                const links = [
                    {source: 0, target: 4, value: 40},
                    {source: 1, target: 4, value: 20},
                    {source: 2, target: 4, value: 18},
                    {source: 3, target: 4, value: 15}
                ];
                
                const sankey = d3.sankey()
                    .nodeWidth(14)
                    .nodePadding(16)
                    .extent([[1, 1], [width - 1, height - 6]]);
                
                const {nodes: sankeyNodes, links: sankeyLinks} = sankey({
                    nodes: nodes.map(d => ({...d})),
                    links: links.map(d => ({...d}))
                });
                
                const colors = ["#f59e0b", "#ec4899", "#10b981", "#3b82f6", "#64748b"];
                
                svg.append('g')
                    .selectAll('path')
                    .data(sankeyLinks)
                    .join('path')
                    .attr('class', 'sankey-link')
                    .attr('d', d3.sankeyLinkHorizontal())
                    .attr('stroke', (d) => colors[d.source.index])
                    .attr('stroke-width', d => Math.max(1, d.width));
                
                const node = svg.append('g')
                    .selectAll('g')
                    .data(sankeyNodes)
                    .join('g')
                    .attr('class', 'sankey-node');
                
                node.append('rect')
                    .attr('x', d => d.x0)
                    .attr('y', d => d.y0)
                    .attr('height', d => d.y1 - d.y0)
                    .attr('width', d => d.x1 - d.x0)
                    .attr('fill', (d, i) => colors[i])
                    .attr('rx', 2);
                
                node.append('text')
                    .attr('x', d => d.x0 < width / 2 ? d.x1 + 6 : d.x0 - 6)
                    .attr('y', d => (d.y1 + d.y0) / 2)
                    .attr('dy', '0.35em')
                    .attr('text-anchor', d => d.x0 < width / 2 ? 'start' : 'end')
                    .text(d => d.name)
                    .style('font-size', '11px')
                    .style('fill', '#fafafa');
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderMarketSankey();
            renderImportTreemap();
            renderMfgLeadTimes();
            renderManufacturerCards();
            renderTreemap('switchgear-treemap', switchgearMarket, 500, 300);
            renderTreemap('hvdc-treemap', hvdcProducers, 500, 300);
            renderTreemap('lpt-market-treemap', lptMarketShare, 800, 250);
            
            // Render transformer sankey when tab is shown
            document.querySelector('[data-tab="transformers"]').addEventListener('click', () => {
                setTimeout(() => {
                    if (!document.querySelector('#transformer-sankey svg')) {
                        renderTransformerSankey();
                    }
                }, 100);
            });
            
            // Render materials sankey when tab is shown
            document.querySelector('[data-tab="materials"]').addEventListener('click', () => {
                setTimeout(() => {
                    if (!document.querySelector('#goes-sankey svg')) {
                        renderGoesSankey();
                    }
                }, 100);
            });
            
            // Render component sankeys when tab is shown
            document.querySelector('[data-tab="components"]').addEventListener('click', () => {
                setTimeout(() => {
                    if (!document.querySelector('#bushing-sankey svg')) {
                        renderComponentSankeys();
                    }
                }, 100);
            });
        });
        
        // Handle resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                // Clear and re-render SVGs on resize
                document.querySelectorAll('.sankey-container svg, .treemap-container svg').forEach(svg => svg.remove());
                renderMarketSankey();
                renderImportTreemap();
                renderTreemap('switchgear-treemap', switchgearMarket, 500, 300);
                renderTreemap('hvdc-treemap', hvdcProducers, 500, 300);
                renderTreemap('lpt-market-treemap', lptMarketShare, 800, 250);
            }, 250);
        });
    </script>
</body>
</html>
